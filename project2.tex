% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={R Notebook},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering

\title{R Notebook}
\author{}
\date{\vspace{-2.5em}}

\begin{document}
\maketitle

This is an \href{http://rmarkdown.rstudio.com}{R Markdown} Notebook.
When you execute code within the notebook, the results appear beneath
the code.

Try executing this chunk by clicking the \emph{Run} button within the
chunk or by placing your cursor inside it and pressing
\emph{Ctrl+Shift+Enter}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# set scienfic notation to decimals}
\KeywordTok{options}\NormalTok{(}\DataTypeTok{scipen =} \DecValTok{999}\NormalTok{)}
\KeywordTok{options}\NormalTok{(}\DataTypeTok{warn=}\OperatorTok{-}\DecValTok{1}\NormalTok{)}

\KeywordTok{options}\NormalTok{(}\DataTypeTok{xtable.floating =} \OtherTok{FALSE}\NormalTok{)}
\KeywordTok{options}\NormalTok{(}\DataTypeTok{xtable.timestamp =} \StringTok{""}\NormalTok{)}

\CommentTok{# ff data}
\NormalTok{df_rf <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{'F-F_Research_Data_Factors_daily.CSV'}\NormalTok{, }\DataTypeTok{skip=}\DecValTok{4}\NormalTok{)}
\NormalTok{df_rf}\OperatorTok{$}\NormalTok{X =}\StringTok{ }\KeywordTok{ymd}\NormalTok{(df_rf}\OperatorTok{$}\NormalTok{X)}
\KeywordTok{names}\NormalTok{(df_rf)[}\KeywordTok{names}\NormalTok{(df_rf) }\OperatorTok{==}\StringTok{ "X"}\NormalTok{] <-}\StringTok{ "Date"}
\NormalTok{df_rf <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(df_rf, Date }\OperatorTok{>=}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(}\StringTok{'2011-1-1'}\NormalTok{))}
\NormalTok{df_rf <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(df_rf, Date }\OperatorTok{<=}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(}\StringTok{'2018-05-31'}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{read-coin-data}{%
\section{Read coin data}\label{read-coin-data}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# reading coin data}
\NormalTok{df =}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{'consolidated_coin_data.csv'}\NormalTok{)}
\NormalTok{df}\OperatorTok{$}\NormalTok{Date =}\StringTok{ }\KeywordTok{mdy}\NormalTok{(df}\OperatorTok{$}\NormalTok{Date)}
\CommentTok{# set dt as datatable}
\KeywordTok{setDT}\NormalTok{(df)}

\CommentTok{# reading btc data from coindesk}
\NormalTok{df_btc2 <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{'coindesk-btc-price.csv'}\NormalTok{)}
\NormalTok{df_btc2}\OperatorTok{$}\NormalTok{Date =}\StringTok{ }\KeywordTok{ymd}\NormalTok{(df_btc2}\OperatorTok{$}\NormalTok{Date) }
\KeywordTok{names}\NormalTok{(df_btc2)[}\KeywordTok{names}\NormalTok{(df_btc2) }\OperatorTok{==}\StringTok{ "Price"}\NormalTok{] <-}\StringTok{ "Close"}
\NormalTok{df_btc <-}\StringTok{ }\NormalTok{df_btc2 }\OperatorTok{%>%}\StringTok{ }\KeywordTok{arrange}\NormalTok{(Date)}
\NormalTok{df_btc <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(df_btc, Date }\OperatorTok{>=}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(}\StringTok{'2011-1-1'}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{table-a.1-shape-of-different-currencies}{%
\section{Table a.1 shape of different
currencies}\label{table-a.1-shape-of-different-currencies}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# table a.1 shape of different currencies}
\NormalTok{currencies2 =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'bitcoin'}\NormalTok{)}
\CommentTok{#currencies2 = c('bitcoin', 'ripple', 'ethereum', 'binance-coin' ,'eos','tether', 'bitcoin-cash', 'stellar', 'litecoin', 'cardano')}
\NormalTok{plots =}\StringTok{ }\KeywordTok{list}\NormalTok{()}

\ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(currencies2))\{}

  \CommentTok{# if it is bitcoin, load coindesk data}
  \ControlFlowTok{if}\NormalTok{ (currencies2[j] }\OperatorTok{==}\StringTok{ 'bitcoin'}\NormalTok{)\{}
\NormalTok{    df1 <-}\StringTok{ }\NormalTok{df_btc}
\NormalTok{  \}}\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    df1 <-}\StringTok{ }\NormalTok{df}\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(Currency }\OperatorTok{==}\StringTok{ }\NormalTok{currencies2[j])}
\NormalTok{  \}}

  \CommentTok{# set date as key field}
\NormalTok{  df1=}\StringTok{ }\KeywordTok{data.table}\NormalTok{(df1, }\DataTypeTok{key=}\KeywordTok{c}\NormalTok{(}\StringTok{'Date'}\NormalTok{))}
  
  \CommentTok{# set upper range}
\NormalTok{  df1 <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(df1, Date }\OperatorTok{<=}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(}\StringTok{'2018-5-31'}\NormalTok{)) }
  
  \CommentTok{# calculate daily ,weekly and monthly returns}
\NormalTok{  xts <-}\StringTok{ }\KeywordTok{xts}\NormalTok{(df1}\OperatorTok{$}\NormalTok{Close, df1}\OperatorTok{$}\NormalTok{Date)}
\NormalTok{  dfd <-}\StringTok{ }\KeywordTok{dailyReturn}\NormalTok{(xts, }\DataTypeTok{type=}\StringTok{'log'}\NormalTok{)}
\NormalTok{  dfw <-}\StringTok{ }\KeywordTok{weeklyReturn}\NormalTok{(xts, }\DataTypeTok{type=}\StringTok{'log'}\NormalTok{)}
\NormalTok{  dfm <-}\StringTok{ }\KeywordTok{monthlyReturn}\NormalTok{(xts, }\DataTypeTok{type=}\StringTok{'log'}\NormalTok{)}
  
\NormalTok{  dfm <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Date=}\KeywordTok{index}\NormalTok{(dfm), }\KeywordTok{coredata}\NormalTok{(dfm))}
  \KeywordTok{setDT}\NormalTok{(dfm)}
  
  \CommentTok{# format output}
\NormalTok{  dfm[,Gains}\OperatorTok{:}\ErrorTok{=}\KeywordTok{paste}\NormalTok{(}\KeywordTok{round}\NormalTok{(monthly.returns}\OperatorTok{*}\DecValTok{100}\NormalTok{,}\DecValTok{2}\NormalTok{), }\StringTok{'%'}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{)]}
\NormalTok{  dfm[,Losses}\OperatorTok{:}\ErrorTok{=}\NormalTok{Gains]}
\NormalTok{  dfm}\OperatorTok{$}\NormalTok{Month <-}\StringTok{ }\KeywordTok{format}\NormalTok{(}\KeywordTok{as.Date}\NormalTok{(dfm}\OperatorTok{$}\NormalTok{Date), }\StringTok{"%Y-%m"}\NormalTok{)}

  \CommentTok{#setDT(dfm)}
  
  \CommentTok{# get top 10 gains}
\NormalTok{  top10 =}\StringTok{ }\NormalTok{dfm }\OperatorTok{%>%}\StringTok{  }\KeywordTok{arrange}\NormalTok{(}\KeywordTok{desc}\NormalTok{(monthly.returns)) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{select}\NormalTok{(Month, Gains) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{head}\NormalTok{(}\DecValTok{10}\NormalTok{)}
  
  \CommentTok{# get bottom 10 gains (top 10 losses)}
\NormalTok{  bottom10 =}\StringTok{ }\NormalTok{dfm }\OperatorTok{%>%}\StringTok{  }\KeywordTok{arrange}\NormalTok{(monthly.returns) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{select}\NormalTok{(Month, Losses) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{head}\NormalTok{(}\DecValTok{10}\NormalTok{)}
  
  \CommentTok{# print the top gain and losses table}
\NormalTok{  top_gain_loss <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(top10, bottom10)}
  \KeywordTok{stargazer}\NormalTok{(top_gain_loss, }\DataTypeTok{type=}\StringTok{'text'}\NormalTok{, }\DataTypeTok{summary=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{title=} \KeywordTok{paste}\NormalTok{(currencies2[j],}\StringTok{'Top Gains and Losses'}\NormalTok{))}
  
\NormalTok{  dfd<-}\KeywordTok{as.data.table}\NormalTok{(dfd)}
\NormalTok{  daily =}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(psych}\OperatorTok{::}\KeywordTok{describe}\NormalTok{(dfd}\OperatorTok{$}\NormalTok{daily.returns))}
\NormalTok{  t <-}\StringTok{ }\NormalTok{dfd}\OperatorTok{$}\NormalTok{daily.returns }\OperatorTok{%>%}\StringTok{ }\NormalTok{t.test}
\NormalTok{  daily[[}\StringTok{'se'}\NormalTok{]] =}\StringTok{ }\NormalTok{t}\OperatorTok{$}\NormalTok{statistic[[}\DecValTok{1}\NormalTok{]]}
  
\NormalTok{  dfw<-}\KeywordTok{as.data.table}\NormalTok{(dfw)}
\NormalTok{  weekly =}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(psych}\OperatorTok{::}\KeywordTok{describe}\NormalTok{(dfw}\OperatorTok{$}\NormalTok{weekly.returns))}
\NormalTok{  t <-}\StringTok{ }\NormalTok{dfw}\OperatorTok{$}\NormalTok{weekly.returns }\OperatorTok{%>%}\StringTok{ }\NormalTok{t.test}
\NormalTok{  weekly[[}\StringTok{'se'}\NormalTok{]] =}\StringTok{ }\NormalTok{t}\OperatorTok{$}\NormalTok{statistic[[}\DecValTok{1}\NormalTok{]]}

\NormalTok{  dfm<-}\KeywordTok{as.data.table}\NormalTok{(dfm)}
\NormalTok{  monthly =}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(psych}\OperatorTok{::}\KeywordTok{describe}\NormalTok{(dfm}\OperatorTok{$}\NormalTok{monthly.returns))}
\NormalTok{  t <-}\StringTok{ }\NormalTok{dfm}\OperatorTok{$}\NormalTok{monthly.returns }\OperatorTok{%>%}\StringTok{ }\NormalTok{t.test}
\NormalTok{  monthly[[}\StringTok{'se'}\NormalTok{]] =}\StringTok{ }\NormalTok{t}\OperatorTok{$}\NormalTok{statistic[[}\DecValTok{1}\NormalTok{]]}

  \CommentTok{#merge results}
\NormalTok{  currency_summary <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(daily, weekly, monthly)}

  \CommentTok{# format table}
  \KeywordTok{setDT}\NormalTok{(currency_summary, }\DataTypeTok{keep.rownames =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{  currency_summary <-}\StringTok{ }\NormalTok{currency_summary[,}\KeywordTok{list}\NormalTok{(}\DataTypeTok{Mean=}\KeywordTok{paste0}\NormalTok{(}\KeywordTok{round}\NormalTok{(mean}\OperatorTok{*}\DecValTok{100}\NormalTok{,}\DecValTok{2}\NormalTok{),}\StringTok{'%'}\NormalTok{), }\DataTypeTok{SD=}\KeywordTok{paste0}\NormalTok{(}\KeywordTok{round}\NormalTok{(sd}\OperatorTok{*}\DecValTok{100}\NormalTok{,}\DecValTok{2}\NormalTok{),}\StringTok{'%'}\NormalTok{), }\DataTypeTok{T_Stat=}\KeywordTok{round}\NormalTok{(se,}\DecValTok{2}\NormalTok{), }\DataTypeTok{Skewness=}\KeywordTok{round}\NormalTok{(skew,}\DecValTok{2}\NormalTok{), }\DataTypeTok{Kurtosis=}\KeywordTok{round}\NormalTok{(kurtosis,}\DecValTok{2}\NormalTok{)), by=}\KeywordTok{list}\NormalTok{(rn)]}
  
  \CommentTok{# formate index}
\NormalTok{  currency_summary[,}\DecValTok{1}\NormalTok{] <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'Daily'}\NormalTok{,}\StringTok{'Weekly'}\NormalTok{,}\StringTok{'Monthly'}\NormalTok{)}

  \CommentTok{# print results}
  \KeywordTok{stargazer}\NormalTok{(currency_summary, }\DataTypeTok{type=}\StringTok{'text'}\NormalTok{, }\DataTypeTok{summary=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{title=} \KeywordTok{paste}\NormalTok{(currencies2[j],}\StringTok{'Log Return'}\NormalTok{))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{bitcoin-top-gains-and-losses}{%
\section{bitcoin Top Gains and
Losses}\label{bitcoin-top-gains-and-losses}}

\hypertarget{month-gains-month.1-losses}{%
\subsection{Month Gains Month.1
Losses}\label{month-gains-month.1-losses}}

1 2013-11 173.59\% 2011-08 -48.74\% 2 2011-04 149.53\% 2011-09 -46.7\% 3
2013-03 102.5\% 2011-10 -45.9\% 4 2011-05 91.53\% 2014-02 -44.44\% 5
2011-06 61.09\% 2018-03 -39.78\% 6 2011-01 55\% 2013-12 -39.53\% 7
2017-05 54.74\% 2015-01 -38.79\% 8 2017-08 50.56\% 2018-01 -30.99\% 9
2011-02 50.31\% 2013-06 -27.84\% 10 2013-02 49.19\% 2014-09 -21.32\%
----------------------------------

\hypertarget{bitcoin-log-return}{%
\section{bitcoin Log Return}\label{bitcoin-log-return}}

\hypertarget{rn-mean-sd-t_stat-skewness-kurtosis}{%
\subsection{rn Mean SD T\_Stat Skewness
Kurtosis}\label{rn-mean-sd-t_stat-skewness-kurtosis}}

1 Daily 0.37\% 5.51\% 3.530 -0.300 11.850 2 Weekly 2.61\% 14.99\% 3.430
0.520 3.630\\
3 Monthly 11.38\% 36.81\% 2.920 1.630 4.800\\
------------------------------------------------

\hypertarget{table-14---calculate-daily-and-weekly-momentum-for-different-currencies}{%
\section{Table 14 - Calculate daily and weekly momentum for different
currencies}\label{table-14---calculate-daily-and-weekly-momentum-for-different-currencies}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#currencies <- unique(df$Currency)}
\NormalTok{currencies2 =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'bitcoin'}\NormalTok{)}
\CommentTok{#currencies2 = c('bitcoin', 'ripple', 'ethereum', 'binance-coin' ,'eos','tether', 'bitcoin-cash', 'stellar', 'litecoin', 'cardano')}
\CommentTok{#currencies3 = c('binance-coin' ,'eos','tether', 'bitcoin-cash', 'stellar', 'litecoin','ethereum', 'cardano')}
\NormalTok{plots =}\StringTok{ }\KeywordTok{list}\NormalTok{()}

\ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(currencies2))\{}

  \CommentTok{#df1 <- df%>% filter(Currency == 'ripple')}
  \ControlFlowTok{if}\NormalTok{ (currencies2[j] }\OperatorTok{==}\StringTok{ 'bitcoin'}\NormalTok{)\{}
\NormalTok{    df1 <-}\StringTok{ }\NormalTok{df_btc}
\NormalTok{  \}}\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    df1 <-}\StringTok{ }\NormalTok{df}\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(Currency }\OperatorTok{==}\StringTok{ }\NormalTok{currencies2[j])}
\NormalTok{  \}}
  

  \CommentTok{# set date as key field}
\NormalTok{  df1=}\StringTok{ }\KeywordTok{data.table}\NormalTok{(df1, }\DataTypeTok{key=}\KeywordTok{c}\NormalTok{(}\StringTok{'Date'}\NormalTok{))}
  
  \CommentTok{# set upper range}
\NormalTok{  df1 <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(df1, Date }\OperatorTok{<=}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(}\StringTok{'2018-5-31'}\NormalTok{)) }

  \CommentTok{# create close price lag 1}
\NormalTok{  df1[, Close_lag1}\OperatorTok{:}\ErrorTok{=}\KeywordTok{shift}\NormalTok{(Close, }\DataTypeTok{n=}\DecValTok{1}\NormalTok{, }\DataTypeTok{fill=}\OtherTok{NA}\NormalTok{, }\DataTypeTok{type=}\StringTok{'lag'}\NormalTok{)]}
  
  \CommentTok{# return = (price of t/ price of t-1) -1}
\NormalTok{  df1[, plot_ret}\OperatorTok{:}\ErrorTok{=}\StringTok{ }\NormalTok{((Close}\OperatorTok{/}\NormalTok{Close_lag1)}\OperatorTok{-}\DecValTok{1}\NormalTok{)]}
\NormalTok{  df1[, ret}\OperatorTok{:}\ErrorTok{=}\StringTok{ }\NormalTok{((Close}\OperatorTok{/}\NormalTok{Close_lag1)}\OperatorTok{-}\DecValTok{1}\NormalTok{)]}
\NormalTok{  df1}
  
  \CommentTok{# Table 14, 18 - daily momentum}
  \CommentTok{# create lead and lag}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{7}\NormalTok{)\{}
\NormalTok{    df1[, }\KeywordTok{paste}\NormalTok{(}\StringTok{'ret_lead'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(i),}\DataTypeTok{sep=}\StringTok{""}\NormalTok{)}\OperatorTok{:}\ErrorTok{=}\KeywordTok{shift}\NormalTok{(ret, }\DataTypeTok{n=}\NormalTok{i, }\DataTypeTok{fill =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{type=}\StringTok{'lead'}\NormalTok{)]}
\NormalTok{  \}}
  
  \CommentTok{# generate formula}
\NormalTok{  model_results1 =}\StringTok{ }\KeywordTok{list}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{7}\NormalTok{)\{}
    \CommentTok{#f <- as.formula(paste('ret ~ ret_lead',paste(i), sep=""))}
    \CommentTok{#f <- as.formula(paste('(ret_lead',paste(i), '- rf_lead',paste(i) ,')~ ret', sep=""))}
\NormalTok{    f <-}\StringTok{ }\KeywordTok{as.formula}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{'ret_lead'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(i) ,}\StringTok{'~ ret'}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{))}
\NormalTok{    m =}\StringTok{ }\KeywordTok{lm}\NormalTok{(f, }\DataTypeTok{data=}\NormalTok{ df1)}
\NormalTok{    model_results1[[i]] =}\StringTok{ }\NormalTok{m}
\NormalTok{  \}}
  
  \CommentTok{#print daily return}
  \KeywordTok{stargazer}\NormalTok{(model_results1, }\DataTypeTok{header=}\NormalTok{F, }\DataTypeTok{type=}\StringTok{'text'}\NormalTok{,}
            \DataTypeTok{title=}\KeywordTok{paste}\NormalTok{(currencies2[j],}\StringTok{'Daily Return ('}\NormalTok{, }\KeywordTok{paste}\NormalTok{(}\KeywordTok{min}\NormalTok{(df1}\OperatorTok{$}\NormalTok{Date)),}\StringTok{'-'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(}\KeywordTok{max}\NormalTok{(df1}\OperatorTok{$}\NormalTok{Date)),}\StringTok{')'}\NormalTok{),}
            \DataTypeTok{omit.stat =} \KeywordTok{c}\NormalTok{(}\StringTok{'LL'}\NormalTok{,}\StringTok{'ser'}\NormalTok{,}\StringTok{'f'}\NormalTok{),}
            \CommentTok{#t = list(NULL, sqrt(1)),}
            \DataTypeTok{covariate.labels =}\KeywordTok{c}\NormalTok{(}\StringTok{'R(t)'}\NormalTok{),}
            \DataTypeTok{dep.var.labels=}\KeywordTok{c}\NormalTok{(}\StringTok{'R(t+1)'}\NormalTok{, }\StringTok{'R(t+2)'}\NormalTok{, }\StringTok{'R(t+3)'}\NormalTok{, }\StringTok{'R(t+4)'}\NormalTok{,}\StringTok{'R(t+5)'}\NormalTok{,}\StringTok{'R(t+6)'}\NormalTok{, }\StringTok{'R(t+7)'}\NormalTok{),}
            \DataTypeTok{omit=}\StringTok{'Constant'}\NormalTok{,}
            \DataTypeTok{report =} \StringTok{'vc*t'}\NormalTok{)}
  \KeywordTok{names}\NormalTok{(model_results1)}
  
  \CommentTok{# Table 14 -weekly momentum}
\NormalTok{  df1 <-}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{day =} \KeywordTok{wday}\NormalTok{(Date), }\DataTypeTok{.data=}\NormalTok{ df1)}
\NormalTok{  df1 <-}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{week =} \KeywordTok{cut.Date}\NormalTok{(Date}\OperatorTok{+}\DecValTok{1}\NormalTok{, }\DataTypeTok{breaks=}\StringTok{'1 week'}\NormalTok{, }\DataTypeTok{label=}\OtherTok{FALSE}\NormalTok{),}\DataTypeTok{.data=}\NormalTok{df1)}
  
  \KeywordTok{setDT}\NormalTok{(df1)}
\NormalTok{  df1[,Close_lead1w}\OperatorTok{:}\ErrorTok{=}\KeywordTok{shift}\NormalTok{(Close, }\DataTypeTok{n=}\DecValTok{7}\NormalTok{, }\DataTypeTok{fill =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{type=}\StringTok{'lead'}\NormalTok{)]}
  
  \CommentTok{# set 1 week lag}
\NormalTok{  df1[,Close_lag1w}\OperatorTok{:}\ErrorTok{=}\KeywordTok{shift}\NormalTok{(Close, }\DataTypeTok{n=}\DecValTok{7}\NormalTok{, }\DataTypeTok{fill =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{type=}\StringTok{'lag'}\NormalTok{)]}
  
\NormalTok{  df1[,weekly_ret}\OperatorTok{:}\ErrorTok{=}\NormalTok{((Close}\OperatorTok{/}\NormalTok{Close_lag1w)}\OperatorTok{-}\DecValTok{1}\NormalTok{)]}
  \KeywordTok{print}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\KeywordTok{mean}\NormalTok{(df1}\OperatorTok{$}\NormalTok{weekly_ret, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{) ,}\KeywordTok{sd}\NormalTok{(df1}\OperatorTok{$}\NormalTok{weekly_ret, }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)))}
  
  \KeywordTok{setDT}\NormalTok{(df1)}
\NormalTok{  df1}
  
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{7}\NormalTok{)\{}
\NormalTok{    df1[, }\KeywordTok{paste}\NormalTok{(}\StringTok{'weekly_ret_lead'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(i),}\DataTypeTok{sep=}\StringTok{""}\NormalTok{)}\OperatorTok{:}\ErrorTok{=}\KeywordTok{shift}\NormalTok{(weekly_ret, }\DataTypeTok{n=}\NormalTok{i}\OperatorTok{*}\DecValTok{7}\NormalTok{, }\DataTypeTok{fill =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{type=}\StringTok{'lead'}\NormalTok{)]}
\NormalTok{  \}}
  
\NormalTok{  df2 <-}\StringTok{ }\NormalTok{df1 }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(day }\OperatorTok{==}\StringTok{ }\DecValTok{1} \OperatorTok{|}\StringTok{ }\NormalTok{Date}\OperatorTok{==}\StringTok{'2018-5-31'}\NormalTok{)}
  \KeywordTok{setDT}\NormalTok{(df2)}
\NormalTok{  model_results =}\StringTok{ }\KeywordTok{list}\NormalTok{()}
  

  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{)\{}
     \CommentTok{#f <- as.formula(paste('ret ~ ret_lead',paste(i), sep=""))}
\NormalTok{     f <-}\StringTok{ }\KeywordTok{as.formula}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{'weekly_ret_lead'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(i), }\StringTok{'~ weekly_ret'}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{))}
\NormalTok{     m =}\StringTok{ }\KeywordTok{lm}\NormalTok{(f, }\DataTypeTok{data=}\NormalTok{ df2)}
\NormalTok{     model_results[[i]] =}\StringTok{ }\NormalTok{m}
\NormalTok{  \}}
  
  \CommentTok{#print table 14}
  \KeywordTok{stargazer}\NormalTok{(model_results, }\DataTypeTok{header=}\NormalTok{F, }\DataTypeTok{type=}\StringTok{'text'}\NormalTok{,}
            \DataTypeTok{title=}\KeywordTok{paste}\NormalTok{(currencies2[j],}\StringTok{' Weekly Return ('}\NormalTok{, }\KeywordTok{paste}\NormalTok{(}\KeywordTok{min}\NormalTok{(df1}\OperatorTok{$}\NormalTok{Date)),}\StringTok{'-'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(}\KeywordTok{max}\NormalTok{(df1}\OperatorTok{$}\NormalTok{Date)),}\StringTok{')'}\NormalTok{),}
            \DataTypeTok{omit.stat =} \KeywordTok{c}\NormalTok{(}\StringTok{"LL"}\NormalTok{,}\StringTok{"ser"}\NormalTok{,}\StringTok{"f"}\NormalTok{),}
            \DataTypeTok{covariate.labels =}\KeywordTok{c}\NormalTok{(}\StringTok{'R(t)'}\NormalTok{),}
            \DataTypeTok{dep.var.labels=}\KeywordTok{c}\NormalTok{(}\StringTok{'R(t+1)'}\NormalTok{, }\StringTok{'R(t+2)'}\NormalTok{, }\StringTok{'R(t+3)'}\NormalTok{, }\StringTok{'R(t+4)'}\NormalTok{),}
            \DataTypeTok{omit=}\StringTok{'Constant'}\NormalTok{)}
  
  
  \ControlFlowTok{if}\NormalTok{ (currencies2[j] }\OperatorTok{==}\StringTok{ 'bitcoin'}\NormalTok{)\{}
\NormalTok{    table26 <-}\StringTok{ }\NormalTok{df2}
\NormalTok{  \}}
  
\NormalTok{\}  }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## bitcoin Daily Return ( 2011-01-01 - 2018-05-31 )
## ====================================================================================
##                                        Dependent variable:                          
##              -----------------------------------------------------------------------
##               R(t+1)     R(t+2)    R(t+3)    R(t+4)    R(t+5)    R(t+6)     R(t+7)  
##                 (1)       (2)        (3)       (4)       (5)       (6)       (7)    
## ------------------------------------------------------------------------------------
## R(t)         0.057***    -0.022    0.033*     0.023   0.067***  0.079***    -0.031  
##              t = 2.994 t = -1.157 t = 1.712 t = 1.177 t = 3.504 t = 4.126 t = -1.590
##                                                                                     
## ------------------------------------------------------------------------------------
## Observations   2,706     2,705      2,704     2,703     2,702     2,701     2,700   
## R2             0.003     0.0005     0.001     0.001     0.005     0.006     0.001   
## Adjusted R2    0.003     0.0001     0.001    0.0001     0.004     0.006     0.001   
## ====================================================================================
## Note:                                                    *p<0.1; **p<0.05; ***p<0.01
## [1] "0.0397480635702246 0.180497353908023"
## 
## bitcoin Weekly Return ( 2011-01-01 - 2018-05-31 )
## ===============================================
##                     Dependent variable:        
##              ----------------------------------
##               R(t+1)   R(t+2)   R(t+3)  R(t+4) 
##                (1)      (2)      (3)      (4)  
## -----------------------------------------------
## R(t)         0.186*** 0.225*** 0.210*** 0.085* 
##              (0.050)  (0.050)  (0.050)  (0.051)
##                                                
## -----------------------------------------------
## Observations   385      384      383      382  
## R2            0.034    0.050    0.044    0.007 
## Adjusted R2   0.032    0.048    0.041    0.005 
## ===============================================
## Note:               *p<0.1; **p<0.05; ***p<0.01
\end{verbatim}

\hypertarget{table-15-bitcoin-returns-by-groups}{%
\section{Table 15 bitcoin returns by
groups}\label{table-15-bitcoin-returns-by-groups}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{quant_summary =}\StringTok{ }\KeywordTok{list}\NormalTok{()}
\NormalTok{cols =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'R(t+1)'}\NormalTok{,}\StringTok{'R(t+2)'}\NormalTok{,}\StringTok{'R(t+3)'}\NormalTok{,}\StringTok{'R(t+4)'}\NormalTok{)}

\CommentTok{#names(dfw)[names(dfw) == "weekly.returns"] <- "weekly_ret"}
\CommentTok{#names(dfw)[names(dfw) == "index"] <- "Date"}

\CommentTok{# bitcoin_weekly <- dfw}
\CommentTok{# for (i in 1:7)\{}
\CommentTok{#     bitcoin_weekly[, paste('weekly_ret_lead',paste(i),sep=""):=shift(weekly_ret, n=i, fill = NA, type='lead')]}
\CommentTok{# \}}

\NormalTok{bitcoin_weekly <-}\StringTok{ }\NormalTok{table26}
\CommentTok{#dft$rank <- rank(dft$google_norm, ties.method = 'first')}
\CommentTok{#dft$bins <- apply_quantiles(dft$rank, bins=5)}
\CommentTok{#bitcoin_weekly[,weekly_ret:=standardize(weekly_ret)]}
\KeywordTok{describe}\NormalTok{(bitcoin_weekly}\OperatorTok{$}\NormalTok{weekly_ret)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    vars   n mean   sd median trimmed mad   min  max range skew kurtosis   se
## X1    1 387 0.04 0.17   0.02    0.02 0.1 -0.45 0.98  1.43 1.76     7.19 0.01
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bitcoin_weekly}\OperatorTok{$}\NormalTok{bins <-}\StringTok{ }\KeywordTok{apply_quantiles}\NormalTok{(bitcoin_weekly}\OperatorTok{$}\NormalTok{weekly_ret, }\DataTypeTok{bins=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           0%          20%          40%          60%          80%         100% 
## -1.445474766 -0.060423841 -0.002330381  0.043734441  0.122171160  1.981043666
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{5}\NormalTok{)\{}
  \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{)\{}
\NormalTok{   f <-}\StringTok{ }\KeywordTok{as.formula}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{'weekly_ret_lead'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(j), }\StringTok{'~ weekly_ret'}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{))}
\NormalTok{     model =}\StringTok{ }\KeywordTok{lm}\NormalTok{(f, }\DataTypeTok{data=}\NormalTok{ bitcoin_weekly }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(bins }\OperatorTok{==}\StringTok{ }\NormalTok{i))}
\NormalTok{     sum <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(model)}
\NormalTok{     sharpe =}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(sum}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{1}\NormalTok{,}\StringTok{'Estimate'}\NormalTok{], }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}\OperatorTok{/}\KeywordTok{sd}\NormalTok{(model}\OperatorTok{$}\NormalTok{model[,}\DecValTok{1}\NormalTok{])}
\NormalTok{     quant_summary[[j]] =}\StringTok{ }\KeywordTok{c}\NormalTok{(sum}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{1}\NormalTok{,], }\DataTypeTok{Sharpe=}\NormalTok{sharpe)}
\NormalTok{  \}}
  
\NormalTok{  single_bin =}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(quant_summary)}
  \KeywordTok{colnames}\NormalTok{(single_bin) <-}\StringTok{ }\NormalTok{cols}
  \CommentTok{#single_bin <- as.data.frame(t(as.matrix(single_bin)))}
  \KeywordTok{setDT}\NormalTok{(single_bin,}\DataTypeTok{keep.rownames =} \OtherTok{TRUE}\NormalTok{)}
  
  \CommentTok{# add *** according to their p value}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\DecValTok{5}\NormalTok{)\{}
\NormalTok{    pvalue <-}\StringTok{ }\NormalTok{single_bin[,..k][}\DecValTok{4}\NormalTok{]}
\NormalTok{    coeff <-}\StringTok{ }\NormalTok{single_bin[,..k][}\DecValTok{1}\NormalTok{]}
    \ControlFlowTok{if}\NormalTok{(pvalue }\OperatorTok{<}\StringTok{ }\FloatTok{0.01}\NormalTok{)\{}
        \CommentTok{#single_bin[1,2] <- paste0(round(coeff,2), '***')}
\NormalTok{    \}}
\NormalTok{  \}}

  \CommentTok{#names(single_bin) <- c('rn','Value','se', 't', 'pr', 'sd')}
  
  \KeywordTok{stargazer}\NormalTok{(single_bin, }\CommentTok{#type='text',}
            \DataTypeTok{summary=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{title=}\KeywordTok{paste}\NormalTok{(}\StringTok{'Bitcoin Weekly Momentum by Groups - bin'}\NormalTok{,i))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:11
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Weekly Momentum by Groups - bin 1} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $$-$0.106$ & $$-$0.072$ & $0.012$ & $0.005$ \\ 
## 2 & Std. Error & $0.030$ & $0.030$ & $0.030$ & $0.037$ \\ 
## 3 & t value & $$-$3.574$ & $$-$2.420$ & $0.411$ & $0.122$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.001$ & $0.018$ & $0.683$ & $0.903$ \\ 
## 5 & Sharpe & $$-$0.776$ & $$-$0.586$ & $0.103$ & $0.031$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table} 
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:12
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Weekly Momentum by Groups - bin 2} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $0.009$ & $$-$0.010$ & $$-$0.00005$ & $0.014$ \\ 
## 2 & Std. Error & $0.026$ & $0.033$ & $0.031$ & $0.029$ \\ 
## 3 & t value & $0.343$ & $$-$0.314$ & $$-$0.001$ & $0.472$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.733$ & $0.754$ & $0.999$ & $0.638$ \\ 
## 5 & Sharpe & $0.068$ & $$-$0.061$ & $$-$0.0003$ & $0.095$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table} 
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:12
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Weekly Momentum by Groups - bin 3} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $$-$0.001$ & $0.041$ & $0.018$ & $0.030$ \\ 
## 2 & Std. Error & $0.023$ & $0.020$ & $0.028$ & $0.023$ \\ 
## 3 & t value & $$-$0.027$ & $2.014$ & $0.655$ & $1.289$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.978$ & $0.048$ & $0.515$ & $0.201$ \\ 
## 5 & Sharpe & $$-$0.005$ & $0.397$ & $0.129$ & $0.255$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table} 
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:12
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Weekly Momentum by Groups - bin 4} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $$-$0.017$ & $$-$0.030$ & $$-$0.118$ & $0.045$ \\ 
## 2 & Std. Error & $0.058$ & $0.052$ & $0.054$ & $0.064$ \\ 
## 3 & t value & $$-$0.297$ & $$-$0.584$ & $$-$2.203$ & $0.709$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.767$ & $0.561$ & $0.031$ & $0.481$ \\ 
## 5 & Sharpe & $$-$0.114$ & $$-$0.224$ & $$-$0.807$ & $0.274$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table} 
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:12
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Weekly Momentum by Groups - bin 5} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $0.052$ & $0.014$ & $0.067$ & $0.068$ \\ 
## 2 & Std. Error & $0.049$ & $0.049$ & $0.047$ & $0.047$ \\ 
## 3 & t value & $1.057$ & $0.296$ & $1.427$ & $1.448$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.294$ & $0.768$ & $0.158$ & $0.152$ \\ 
## 5 & Sharpe & $0.210$ & $0.058$ & $0.286$ & $0.291$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table}
\end{verbatim}

\hypertarget{import-tweet-data}{%
\section{Import tweet data}\label{import-tweet-data}}

We are not able to retrieve the same data source of the tweet post count
data as suggested in the paper as it is exclusive. Therefore, we
retrieve the data from \{\} since \{\} to \{\} as the proxy to estimate
social media sentiment

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Tweet data}
\NormalTok{df_tweets <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{'btc-tweets.csv'}\NormalTok{)}
\KeywordTok{setDT}\NormalTok{(df_tweets)}

\CommentTok{# set count as numeric}
\NormalTok{df_tweets[, Count}\OperatorTok{:}\ErrorTok{=}\KeywordTok{as.numeric}\NormalTok{(Count)]}

\CommentTok{# parse date}
\NormalTok{df_tweets}\OperatorTok{$}\NormalTok{Date =}\StringTok{ }\KeywordTok{ymd}\NormalTok{(df_tweets}\OperatorTok{$}\NormalTok{Date)}

\CommentTok{# set day number}
\NormalTok{df_tweets <-}\StringTok{ }\NormalTok{df_tweets }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{day =} \KeywordTok{wday}\NormalTok{(Date, }\DataTypeTok{week_start =} \KeywordTok{getOption}\NormalTok{(}\StringTok{"lubridate.week.start"}\NormalTok{, }\DecValTok{7}\NormalTok{)))}

\CommentTok{# set week number}
\NormalTok{df_tweets <-}\StringTok{ }\NormalTok{df_tweets }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{week =} \KeywordTok{cut.Date}\NormalTok{(Date, }\DataTypeTok{breaks=}\StringTok{'1 week'}\NormalTok{, }\DataTypeTok{label=}\OtherTok{FALSE}\NormalTok{))}
\CommentTok{#df_tweets <- df_tweets[, cum:=cumsum(Count)] %>% filter(day == 1)}

\CommentTok{# get only day 1 to extract weekly data}
\NormalTok{df_tweets <-}\StringTok{ }\NormalTok{df_tweets }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(week) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{cum =} \KeywordTok{cumsum}\NormalTok{(Count)) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(day }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{)}
\KeywordTok{setDT}\NormalTok{(df_tweets)}

\CommentTok{# set lags}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{)\{}
\NormalTok{  df_tweets[, }\KeywordTok{paste}\NormalTok{(}\StringTok{'cum_lag'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(i),}\DataTypeTok{sep=}\StringTok{''}\NormalTok{)}\OperatorTok{:}\ErrorTok{=}\StringTok{ }\KeywordTok{shift}\NormalTok{(cum, }\DataTypeTok{n=}\NormalTok{i, }\DataTypeTok{fill=}\OtherTok{NA}\NormalTok{, }\DataTypeTok{type=}\StringTok{'lag'}\NormalTok{)]}
  
\NormalTok{\}}

\CommentTok{# weekly average for t-1 to t-4}
\NormalTok{df_tweets[, avg}\OperatorTok{:}\ErrorTok{=}\KeywordTok{sum}\NormalTok{(cum_lag1}\OperatorTok{+}\NormalTok{cum_lag2}\OperatorTok{+}\NormalTok{cum_lag3}\OperatorTok{+}\NormalTok{cum_lag4,}\DataTypeTok{na.rm =} \OtherTok{TRUE}\NormalTok{)}\OperatorTok{/}\DecValTok{4}\NormalTok{, by=}\KeywordTok{list}\NormalTok{(Date)]}


\CommentTok{# calculate the tweet factor count(t) - average(count(t-1 to t-4))}
\NormalTok{df_tweets[, tweet}\OperatorTok{:}\ErrorTok{=}\NormalTok{(cum}\OperatorTok{-}\NormalTok{avg), by=}\KeywordTok{list}\NormalTok{(Date)]}
\KeywordTok{setDT}\NormalTok{(df_tweets)}

\CommentTok{# standardize with mean 0 and sd 1 (suggested by the original report)}
\NormalTok{df_tweets[, tweet_norm}\OperatorTok{:}\ErrorTok{=}\StringTok{ }\KeywordTok{standardize}\NormalTok{(tweet)]}

\CommentTok{# extract useful fields}
\NormalTok{df_tweets <-}\StringTok{ }\NormalTok{df_tweets[, }\KeywordTok{list}\NormalTok{(Date, day, cum, avg, tweet_norm)]}

\KeywordTok{qplot}\NormalTok{(}\DataTypeTok{data=}\NormalTok{df_tweets, }\DataTypeTok{x=}\NormalTok{Date, }\DataTypeTok{y=}\NormalTok{tweet_norm, }\DataTypeTok{geom =} \StringTok{'line'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project2_files/figure-latex/unnamed-chunk-9-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# qplot(data=df2 %>% filter(Date >= as.Date('2014-01-01')), x=Date, y=weekly_ret, geom = 'line')}
\CommentTok{# min(df2$weekly_ret, na.rm=TRUE)}
\KeywordTok{describe}\NormalTok{(df_tweets}\OperatorTok{$}\NormalTok{tweet_norm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    vars   n mean sd median trimmed  mad   min  max range  skew kurtosis   se
## X1    1 316    0  1  -0.02    0.01 0.75 -5.58 5.13 10.71 -0.12      6.6 0.06
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Table 26, 27 Bitcoin twitter}
\NormalTok{dft<-}\KeywordTok{merge}\NormalTok{(bitcoin_weekly, df_tweets, }\DataTypeTok{by=}\StringTok{'Date'}\NormalTok{)}
\NormalTok{quant_summary =}\StringTok{ }\KeywordTok{list}\NormalTok{()}
\NormalTok{model_results3 =}\StringTok{ }\KeywordTok{list}\NormalTok{()}
\CommentTok{#qs = c(0.17, 0.33, 0.5, 0.67, 0.83)}
\CommentTok{#qs = c(0,0.2, 0.4, 0.6, 0.8)}
\NormalTok{qs =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.2}\NormalTok{,}\FloatTok{0.4}\NormalTok{, }\FloatTok{0.6}\NormalTok{, }\FloatTok{0.8}\NormalTok{, }\DecValTok{1}\NormalTok{)}

 \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{7}\NormalTok{)\{}
   \CommentTok{#f <- as.formula(paste('ret ~ ret_lead',paste(i), sep=""))}
\NormalTok{   f <-}\StringTok{ }\KeywordTok{as.formula}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{'weekly_ret_lead'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(i), }\StringTok{'~ tweet_norm'}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{))}
   \CommentTok{#f <- as.formula(paste('weekly_ret_lead4 ~ tweet_norm', sep=""))}
   
\NormalTok{   m =}\StringTok{ }\KeywordTok{lm}\NormalTok{(f, }\DataTypeTok{data=}\NormalTok{ dft)}
\NormalTok{   model_results3[[i]] =}\StringTok{ }\NormalTok{m}
\NormalTok{\}}

\KeywordTok{stargazer}\NormalTok{(model_results3, }\DataTypeTok{type=}\StringTok{'text'}\NormalTok{, }\DataTypeTok{header=}\NormalTok{F,}
            \DataTypeTok{title=}\KeywordTok{paste}\NormalTok{(}\StringTok{'Bitcoin Weekly Return Twitter ('}\NormalTok{, }\KeywordTok{paste}\NormalTok{(}\KeywordTok{min}\NormalTok{(dft}\OperatorTok{$}\NormalTok{Date)),}\StringTok{'-'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(}\KeywordTok{max}\NormalTok{(dft}\OperatorTok{$}\NormalTok{Date)),}\StringTok{')'}\NormalTok{),}
            \DataTypeTok{omit.stat =} \KeywordTok{c}\NormalTok{(}\StringTok{"LL"}\NormalTok{,}\StringTok{"ser"}\NormalTok{,}\StringTok{"f"}\NormalTok{),}
            \DataTypeTok{covariate.labels =}\KeywordTok{c}\NormalTok{(}\StringTok{'Twitter(t)'}\NormalTok{),}
            \DataTypeTok{dep.var.labels=}\KeywordTok{c}\NormalTok{(}\StringTok{'R(t+1)'}\NormalTok{, }\StringTok{'R(t+2)'}\NormalTok{, }\StringTok{'R(t+3)'}\NormalTok{, }\StringTok{'R(t+4)'}\NormalTok{,}\StringTok{'R(t+5)'}\NormalTok{,}\StringTok{'R(t+6)'}\NormalTok{,}\StringTok{'R(t+7)'}\NormalTok{),}
            \DataTypeTok{omit=}\StringTok{'Constant'}\NormalTok{,}
            \DataTypeTok{report =} \StringTok{"vc*pt"}\NormalTok{, }\DataTypeTok{flip=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{bitcoin-weekly-return-twitter-2014-04-13---2018-05-27}{%
\section{Bitcoin Weekly Return Twitter ( 2014-04-13 - 2018-05-27
)}\label{bitcoin-weekly-return-twitter-2014-04-13---2018-05-27}}

\begin{verbatim}
                                   Dependent variable:                           
         ------------------------------------------------------------------------
           R(t+1)     R(t+2)    R(t+3)     R(t+4)    R(t+5)    R(t+6)    R(t+7)  
            (1)        (2)        (3)       (4)        (5)       (6)       (7)   
\end{verbatim}

\begin{longtable}[]{@{}l@{}}
\toprule
\endhead
\begin{minipage}[t]{0.97\columnwidth}\raggedright
Twitter(t) -0.018** -0.011 0.001 -0.004 0.003 0.013* 0.014* p = 0.016 p
= 0.130 p = 0.945 p = 0.599 p = 0.731 p = 0.075 p = 0.065 t = -2.436 t =
-1.521 t = 0.070 t = -0.528 t = 0.345 t = 1.793 t = 1.857\strut
\end{minipage}\tabularnewline
\bottomrule
\end{longtable}

Observations 215 214 213 212 211 210 209\\
R2 0.027 0.011 0.00002 0.001 0.001 0.015 0.016\\
Adjusted R2 0.023 0.006 -0.005 -0.003 -0.004 0.010 0.012\\
=====================================================================================
Note: \emph{p\textless0.1; \textbf{p\textless0.05; }}p\textless0.01

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(dft, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{Date)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ dft}\OperatorTok{$}\NormalTok{weekly_ret), }\DataTypeTok{color =} \StringTok{"darkred"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ dft}\OperatorTok{$}\NormalTok{tweet_norm), }\DataTypeTok{color=}\StringTok{"blue"}\NormalTok{, }\DataTypeTok{linetype=}\StringTok{"twodash"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project2_files/figure-latex/unnamed-chunk-10-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{quantile}\NormalTok{(dft}\OperatorTok{$}\NormalTok{tweet_norm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     0%         25%         50%         75%        100% 
\end{verbatim}

-5.57938297 -0.41101206 0.05976122 0.58675556 5.12868953 \# Tabble 27
Twitter by Groups

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{quant_summary =}\StringTok{ }\KeywordTok{list}\NormalTok{()}
\NormalTok{cols =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'R(t+1)'}\NormalTok{,}\StringTok{'R(t+2)'}\NormalTok{,}\StringTok{'R(t+3)'}\NormalTok{,}\StringTok{'R(t+4)'}\NormalTok{)}

\CommentTok{#dft$rank <- rank(dft$google_norm, ties.method = 'first')}
\NormalTok{dft}\OperatorTok{$}\NormalTok{bins <-}\StringTok{ }\KeywordTok{apply_quantiles}\NormalTok{(dft}\OperatorTok{$}\NormalTok{tweet_norm, }\DataTypeTok{bins=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     0%         20%         40%         60%         80%        100% 
\end{verbatim}

-6.57938297 -0.54262294 -0.09975822 0.21883999 0.67786230 6.12868953

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{5}\NormalTok{)\{}
  \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{)\{}
\NormalTok{   f <-}\StringTok{ }\KeywordTok{as.formula}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{'weekly_ret_lead'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(j), }\StringTok{'~ tweet_norm'}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{))}
\NormalTok{     model =}\StringTok{ }\KeywordTok{lm}\NormalTok{(f, }\DataTypeTok{data=}\NormalTok{ dft }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(bins }\OperatorTok{==}\StringTok{ }\NormalTok{i))}
\NormalTok{     sum <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(model)}
\NormalTok{     sharpe =}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(sum}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{1}\NormalTok{,}\StringTok{'Estimate'}\NormalTok{], }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}\OperatorTok{/}\KeywordTok{sd}\NormalTok{(model}\OperatorTok{$}\NormalTok{model[,}\DecValTok{1}\NormalTok{])}
\NormalTok{     quant_summary[[j]] =}\StringTok{ }\KeywordTok{c}\NormalTok{(sum}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{1}\NormalTok{,], }\DataTypeTok{Sharpe=}\NormalTok{sharpe)}
\NormalTok{  \}}
  
\NormalTok{  single_bin =}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(quant_summary)}
  \KeywordTok{colnames}\NormalTok{(single_bin) <-}\StringTok{ }\NormalTok{cols}
  \CommentTok{#single_bin <- as.data.frame(t(as.matrix(single_bin)))}
  \KeywordTok{setDT}\NormalTok{(single_bin,}\DataTypeTok{keep.rownames =} \OtherTok{TRUE}\NormalTok{)}
  
  \CommentTok{# add *** according to their p value}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\DecValTok{5}\NormalTok{)\{}
\NormalTok{    pvalue <-}\StringTok{ }\NormalTok{single_bin[,..k][}\DecValTok{4}\NormalTok{]}
\NormalTok{    coeff <-}\StringTok{ }\NormalTok{single_bin[,..k][}\DecValTok{1}\NormalTok{]}
    \CommentTok{# if(pvalue < 0.01)\{}
    \CommentTok{#   single_bin[,..k][1] <- paste0(round(coeff,2), '***')}
    \CommentTok{# \}}
\NormalTok{  \}}

  \CommentTok{#names(single_bin) <- c('rn','Value','se', 't', 'pr', 'sd')}
  
  \KeywordTok{stargazer}\NormalTok{(single_bin,}\CommentTok{# type='text', }
            \DataTypeTok{summary=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{title=}\KeywordTok{paste}\NormalTok{(}\StringTok{'Bitcoin Twitter by Groups - bin'}\NormalTok{,i))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\% Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard
University. E-mail: hlavac at fas.harvard.edu \% Date and time: 週三,
五月 20, 2020 - 上午 01:14:13 \textbackslash begin\{table\}{[}!htbp{]}
\centering 

\caption{Bitcoin Twitter by Groups - bin 1} 
  \label{}

\textbackslash begin\{tabular\}\{@\{\extracolsep{5pt}\} cccccc\}
\textbackslash{[}-1.8ex{]}\hline  \hline \textbackslash{[}-1.8ex{]} \&
rn \& R(t+1) \& R(t+2) \& R(t+3) \& R(t+4) \textbackslash{}
\hline \textbackslash{[}-1.8ex{]} 1 \& Estimate \&
\[-$0.009$ & $0.054$ & $0.055$ & \]-\(0.029\) \textbackslash{} 2 \& Std.
Error \& \(0.029\) \& \(0.029\) \& \(0.028\) \& \(0.027\)
\textbackslash{} 3 \& t value \&
\[-$0.303$ & $1.840$ & $1.974$ & \]-\(1.060\) \textbackslash{} 4 \&
Pr(\textgreater \textbar t\textbar ) \& \(0.764\) \& \(0.073\) \&
\(0.055\) \& \(0.295\) \textbackslash{} 5 \& Sharpe \&
\[-$0.069$ & $0.447$ & $0.472$ & \]-\(0.252\) \textbackslash{}
\hline \textbackslash{[}-1.8ex{]} \textbackslash end\{tabular\}
\textbackslash end\{table\}

\% Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard
University. E-mail: hlavac at fas.harvard.edu \% Date and time: 週三,
五月 20, 2020 - 上午 01:14:13 \textbackslash begin\{table\}{[}!htbp{]}
\centering 

\caption{Bitcoin Twitter by Groups - bin 2} 
  \label{}

\textbackslash begin\{tabular\}\{@\{\extracolsep{5pt}\} cccccc\}
\textbackslash{[}-1.8ex{]}\hline  \hline \textbackslash{[}-1.8ex{]} \&
rn \& R(t+1) \& R(t+2) \& R(t+3) \& R(t+4) \textbackslash{}
\hline \textbackslash{[}-1.8ex{]} 1 \& Estimate \& \(0.015\) \&
\[-$0.040$ & $0.043$ & $0.010$ \\ 
2 & Std. Error & $0.036$ & $0.030$ & $0.030$ & $0.036$ \\ 
3 & t value & $0.419$ & \]-\(1.346\) \& \(1.428\) \& \(0.288\)
\textbackslash{} 4 \& Pr(\textgreater \textbar t\textbar ) \& \(0.677\)
\& \(0.186\) \& \(0.161\) \& \(0.775\) \textbackslash{} 5 \& Sharpe \&
\(0.162\) \& \$\$-\(0.499\) \& \(0.551\) \& \(0.114\) \textbackslash{}
\hline \textbackslash{[}-1.8ex{]} \textbackslash end\{tabular\}
\textbackslash end\{table\}

\% Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard
University. E-mail: hlavac at fas.harvard.edu \% Date and time: 週三,
五月 20, 2020 - 上午 01:14:13

\begin{table}[!htbp] \centering 
  \caption{Bitcoin Twitter by Groups - bin 3} 
  \label{} 
\begin{tabular}{@{\extracolsep{5pt}} cccccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
\hline \\[-1.8ex] 
1 & Estimate & $0.025$ & $0.045$ & $0.051$ & $0.013$ \\ 
2 & Std. Error & $0.021$ & $0.023$ & $0.022$ & $0.023$ \\ 
3 & t value & $1.202$ & $1.939$ & $2.335$ & $0.588$ \\ 
4 & Pr(\textgreater \textbar t\textbar ) & $0.236$ & $0.059$ & $0.025$ & $0.560$ \\ 
5 & Sharpe & $0.230$ & $0.370$ & $0.446$ & $0.111$ \\ 
\hline \\[-1.8ex] 
\end{tabular} 
\end{table}

\% Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard
University. E-mail: hlavac at fas.harvard.edu \% Date and time: 週三,
五月 20, 2020 - 上午 01:14:13 \textbackslash begin\{table\}{[}!htbp{]}
\centering 

\caption{Bitcoin Twitter by Groups - bin 4} 
  \label{}

\textbackslash begin\{tabular\}\{@\{\extracolsep{5pt}\} cccccc\}
\textbackslash{[}-1.8ex{]}\hline  \hline \textbackslash{[}-1.8ex{]} \&
rn \& R(t+1) \& R(t+2) \& R(t+3) \& R(t+4) \textbackslash{}
\hline \textbackslash{[}-1.8ex{]} 1 \& Estimate \&
\[-$0.037$ & $0.020$ & \]-\(0.002\) \& \(0.151\) \textbackslash{} 2 \&
Std. Error \& \(0.056\) \& \(0.060\) \& \(0.053\) \& \(0.065\)
\textbackslash{} 3 \& t value \& \[-$0.661$ & $0.331$ & \]-\(0.044\) \&
\(2.315\) \textbackslash{} 4 \& Pr(\textgreater \textbar t\textbar ) \&
\(0.512\) \& \(0.742\) \& \(0.965\) \& \(0.026\) \textbackslash{} 5 \&
Sharpe \& \[-$0.350$ & $0.178$ & \]-\(0.023\) \& \(1.203\)
\textbackslash{} \hline \textbackslash{[}-1.8ex{]}
\textbackslash end\{tabular\} \textbackslash end\{table\}

\% Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard
University. E-mail: hlavac at fas.harvard.edu \% Date and time: 週三,
五月 20, 2020 - 上午 01:14:13 \textbackslash begin\{table\}{[}!htbp{]}
\centering 

\caption{Bitcoin Twitter by Groups - bin 5} 
  \label{}

\textbackslash begin\{tabular\}\{@\{\extracolsep{5pt}\} cccccc\}
\textbackslash{[}-1.8ex{]}\hline  \hline \textbackslash{[}-1.8ex{]} \&
rn \& R(t+1) \& R(t+2) \& R(t+3) \& R(t+4) \textbackslash{}
\hline \textbackslash{[}-1.8ex{]} 1 \& Estimate \&
\[-$0.027$ & $0.062$ & $0.053$ & $0.052$ \\ 
2 & Std. Error & $0.033$ & $0.030$ & $0.037$ & $0.026$ \\ 
3 & t value & \]-\(0.818\) \& \(2.048\) \& \(1.422\) \& \(2.019\)
\textbackslash{} 4 \& Pr(\textgreater \textbar t\textbar ) \& \(0.418\)
\& \(0.047\) \& \(0.163\) \& \(0.050\) \textbackslash{} 5 \& Sharpe \&
\$\$-\(0.227\) \& \(0.540\) \& \(0.392\) \& \(0.545\) \textbackslash{}
\hline \textbackslash{[}-1.8ex{]} \textbackslash end\{tabular\}
\textbackslash end\{table\}

\hypertarget{import-bitcoin-google-search-data}{%
\section{Import bitcoin google search
data}\label{import-bitcoin-google-search-data}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df_google =}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{'trends_bitcoin_weekly_Globe_full.csv'}\NormalTok{)}
\NormalTok{df_google}\OperatorTok{$}\NormalTok{Date =}\StringTok{ }\KeywordTok{ymd}\NormalTok{(df_google}\OperatorTok{$}\NormalTok{date)}
\NormalTok{df_google <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(df_google, Date }\OperatorTok{>=}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(}\StringTok{'2011-1-1'}\NormalTok{))}
\NormalTok{df_google <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(df_google, Date }\OperatorTok{<=}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(}\StringTok{'2018-12-31'}\NormalTok{))}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{day =} \KeywordTok{wday}\NormalTok{(Date, }\DataTypeTok{week_start =} \KeywordTok{getOption}\NormalTok{(}\StringTok{"lubridate.week.start"}\NormalTok{, }\DecValTok{7}\NormalTok{)))}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{week =} \KeywordTok{cut.Date}\NormalTok{(Date, }\DataTypeTok{breaks=}\StringTok{'1 week'}\NormalTok{, }\DataTypeTok{label=}\OtherTok{FALSE}\NormalTok{))}
\CommentTok{#df_tweets <- df_tweets[, cum:=cumsum(Count)] %>% filter(day == 1)}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(week) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{cum =} \KeywordTok{cumsum}\NormalTok{(bitcoin)) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(day }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{)}

\KeywordTok{setDT}\NormalTok{(df_google)}


\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{)\{}
\NormalTok{  df_google[, }\KeywordTok{paste}\NormalTok{(}\StringTok{'cum_lag'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(i),}\DataTypeTok{sep=}\StringTok{''}\NormalTok{)}\OperatorTok{:}\ErrorTok{=}\StringTok{ }\KeywordTok{shift}\NormalTok{(bitcoin, }\DataTypeTok{n=}\NormalTok{i, }\DataTypeTok{fill=}\OtherTok{NA}\NormalTok{, }\DataTypeTok{type=}\StringTok{'lag'}\NormalTok{)]}
\NormalTok{\}}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google[, avg}\OperatorTok{:}\ErrorTok{=}\KeywordTok{sum}\NormalTok{(cum_lag1}\OperatorTok{+}\NormalTok{cum_lag2}\OperatorTok{+}\NormalTok{cum_lag3}\OperatorTok{+}\NormalTok{cum_lag4,}\DataTypeTok{na.rm =} \OtherTok{TRUE}\NormalTok{)}\OperatorTok{/}\DecValTok{4}\NormalTok{, by=}\KeywordTok{list}\NormalTok{(Date)]}

\CommentTok{# calculate the tweet factor count(t) - average(count(t-1 to t-4))}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google[, google}\OperatorTok{:}\ErrorTok{=}\NormalTok{cum}\OperatorTok{-}\NormalTok{avg, by=}\KeywordTok{list}\NormalTok{(Date)]}
\KeywordTok{setDT}\NormalTok{(df_google)}

\CommentTok{# standardize to mean 0 and sd 1}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google[, google_norm}\OperatorTok{:}\ErrorTok{=}\StringTok{ }\KeywordTok{standardize}\NormalTok{(google)]}

\CommentTok{# plot and describe}
\KeywordTok{qplot}\NormalTok{(}\DataTypeTok{data=}\NormalTok{df_google, }\DataTypeTok{x=}\NormalTok{Date, }\DataTypeTok{y=}\NormalTok{google_norm,}\DataTypeTok{geom =} \StringTok{'line'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project2_files/figure-latex/unnamed-chunk-13-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{describe}\NormalTok{(df_google}\OperatorTok{$}\NormalTok{google_norm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    vars   n mean sd median trimmed  mad  min   max range skew kurtosis   se
## X1    1 418    0  1  -0.01   -0.02 0.07 -7.1 10.43 17.52 2.85    46.78 0.05
\end{verbatim}

\hypertarget{table-18---google-search-2011-2018-weekly-return-momentum}{%
\section{Table 18 - google search 2011-2018 weekly return
momentum}\label{table-18---google-search-2011-2018-weekly-return-momentum}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dft<-}\KeywordTok{merge}\NormalTok{(bitcoin_weekly, df_google, }\DataTypeTok{by=}\StringTok{'Date'}\NormalTok{)}
\NormalTok{quant_summary =}\StringTok{ }\KeywordTok{list}\NormalTok{()}
\NormalTok{model_results4 =}\StringTok{ }\KeywordTok{list}\NormalTok{()}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{7}\NormalTok{)\{}
\NormalTok{   f <-}\StringTok{ }\KeywordTok{as.formula}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{'weekly_ret_lead'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(i), }\StringTok{'~ google_norm'}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{))}
\NormalTok{   m =}\StringTok{ }\KeywordTok{lm}\NormalTok{(f, }\DataTypeTok{data=}\NormalTok{ dft)}
\NormalTok{   model_results4[[i]] =}\StringTok{ }\NormalTok{m}
\NormalTok{\}}
\CommentTok{#quantile(dft$google_norm)}
\KeywordTok{stargazer}\NormalTok{(model_results4, }\DataTypeTok{header=}\NormalTok{F, }\DataTypeTok{type=}\StringTok{'text'}\NormalTok{,}
            \DataTypeTok{title=}\KeywordTok{paste}\NormalTok{(}\StringTok{'Google Search - Bitcoin ('}\NormalTok{, }\KeywordTok{paste}\NormalTok{(}\KeywordTok{min}\NormalTok{(dft}\OperatorTok{$}\NormalTok{Date)),}\StringTok{'-'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(}\KeywordTok{max}\NormalTok{(dft}\OperatorTok{$}\NormalTok{Date)),}\StringTok{')'}\NormalTok{),}
            \DataTypeTok{omit.stat =} \KeywordTok{c}\NormalTok{(}\StringTok{"LL"}\NormalTok{,}\StringTok{"ser"}\NormalTok{,}\StringTok{"f"}\NormalTok{),}
            \DataTypeTok{covariate.labels =}\KeywordTok{c}\NormalTok{(}\StringTok{'Google(t)'}\NormalTok{),}
            \DataTypeTok{dep.var.labels=}\KeywordTok{c}\NormalTok{(}\StringTok{'R(t+1)'}\NormalTok{, }\StringTok{'R(t+2)'}\NormalTok{, }\StringTok{'R(t+3)'}\NormalTok{, }\StringTok{'R(t+4)'}\NormalTok{,}\StringTok{'R(t+5)'}\NormalTok{,}\StringTok{'R(t+6)'}\NormalTok{,}\StringTok{'R(t+7)'}\NormalTok{),}
            \DataTypeTok{omit=}\StringTok{'Constant'}\NormalTok{,}
            \DataTypeTok{report =} \StringTok{"vc*pt"}\NormalTok{, }\DataTypeTok{flip=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Google Search - Bitcoin ( 2011-01-02 - 2018-05-27 )
## ===================================================================================
##                                       Dependent variable:                          
##              ----------------------------------------------------------------------
##               R(t+1)    R(t+2)    R(t+3)    R(t+4)    R(t+5)    R(t+6)     R(t+7)  
##                 (1)       (2)       (3)       (4)       (5)       (6)       (7)    
## -----------------------------------------------------------------------------------
## Google(t)     0.018**  0.021***    0.011     0.005     0.009    0.0003     -0.011  
##              p = 0.028 p = 0.010 p = 0.200 p = 0.510 p = 0.254 p = 0.971 p = 0.154 
##              t = 2.208 t = 2.625 t = 1.284 t = 0.660 t = 1.145 t = 0.037 t = -1.431
##                                                                                    
## -----------------------------------------------------------------------------------
## Observations    386       385       384       383       382       381       380    
## R2             0.013     0.018     0.004     0.001     0.003    0.00000    0.005   
## Adjusted R2    0.010     0.015     0.002    -0.001     0.001    -0.003     0.003   
## ===================================================================================
## Note:                                                   *p<0.1; **p<0.05; ***p<0.01
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(dft, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{Date)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ dft}\OperatorTok{$}\NormalTok{weekly_ret), }\DataTypeTok{color =} \StringTok{"darkred"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ dft}\OperatorTok{$}\NormalTok{google_norm), }\DataTypeTok{color=}\StringTok{"blue"}\NormalTok{, }\DataTypeTok{linetype=}\StringTok{"twodash"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project2_files/figure-latex/unnamed-chunk-14-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
  \CommentTok{#geom_line(aes(y = dft$tweet_norm), color="green", linetype="twodash") }
\end{Highlighting}
\end{Shaded}

\hypertarget{table-20-google-by-groups}{%
\section{Table 20 Google by Groups}\label{table-20-google-by-groups}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{quant_summary =}\StringTok{ }\KeywordTok{list}\NormalTok{()}
\NormalTok{cols =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'R(t+1)'}\NormalTok{,}\StringTok{'R(t+2)'}\NormalTok{,}\StringTok{'R(t+3)'}\NormalTok{,}\StringTok{'R(t+4)'}\NormalTok{)}

\NormalTok{dft}\OperatorTok{$}\NormalTok{rank <-}\StringTok{ }\KeywordTok{rank}\NormalTok{(dft}\OperatorTok{$}\NormalTok{google_norm, }\DataTypeTok{ties.method =} \StringTok{'first'}\NormalTok{)}
\NormalTok{dft}\OperatorTok{$}\NormalTok{bins <-}\StringTok{ }\KeywordTok{apply_quantiles}\NormalTok{(dft}\OperatorTok{$}\NormalTok{rank, }\DataTypeTok{bins=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    0%   20%   40%   60%   80%  100% 
##   0.0  78.2 155.4 232.6 309.8 388.0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{5}\NormalTok{)\{}
  \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{)\{}
\NormalTok{   f <-}\StringTok{ }\KeywordTok{as.formula}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{'weekly_ret_lead'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(j), }\StringTok{'~ google_norm'}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{))}
\NormalTok{     model =}\StringTok{ }\KeywordTok{lm}\NormalTok{(f, }\DataTypeTok{data=}\NormalTok{ dft }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(bins }\OperatorTok{==}\StringTok{ }\NormalTok{i))}
\NormalTok{     sum <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(model)}
\NormalTok{     sharpe =}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(sum}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{1}\NormalTok{,}\StringTok{'Estimate'}\NormalTok{], }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}\OperatorTok{/}\KeywordTok{sd}\NormalTok{(model}\OperatorTok{$}\NormalTok{model[,}\DecValTok{1}\NormalTok{])}
\NormalTok{     quant_summary[[j]] =}\StringTok{ }\KeywordTok{c}\NormalTok{(sum}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{1}\NormalTok{,], }\DataTypeTok{Sharpe=}\NormalTok{sharpe)}
\NormalTok{  \}}
  
\NormalTok{  single_bin =}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(quant_summary)}
  \KeywordTok{colnames}\NormalTok{(single_bin) <-}\StringTok{ }\NormalTok{cols}
  \CommentTok{#single_bin <- as.data.frame(t(as.matrix(single_bin)))}
  \KeywordTok{setDT}\NormalTok{(single_bin,}\DataTypeTok{keep.rownames =} \OtherTok{TRUE}\NormalTok{)}
  
  \CommentTok{# add *** according to their p value}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\DecValTok{5}\NormalTok{)\{}
\NormalTok{    pvalue <-}\StringTok{ }\NormalTok{single_bin[,..k][}\DecValTok{4}\NormalTok{]}
\NormalTok{    coeff <-}\StringTok{ }\NormalTok{single_bin[,..k][}\DecValTok{1}\NormalTok{]}
    \CommentTok{# if(pvalue < 0.01)\{}
    \CommentTok{#   single_bin[,..k][1] <- paste0(round(coeff,2), '***')}
    \CommentTok{# \}}
\NormalTok{  \}}

  \CommentTok{#names(single_bin) <- c('rn','Value','se', 't', 'pr', 'sd')}
  
  \KeywordTok{stargazer}\NormalTok{(single_bin, }\DataTypeTok{type=}\StringTok{'text'}\NormalTok{, }
            \DataTypeTok{summary=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{title=}\KeywordTok{paste}\NormalTok{(}\StringTok{'Bitcoin Google Search by Groups - bin'}\NormalTok{,i))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Bitcoin Google Search by Groups - bin 1
## =========================================
##       rn      R(t+1) R(t+2) R(t+3) R(t+4)
## -----------------------------------------
## 1  Estimate   -0.001 0.023  0.017  0.023 
## 2 Std. Error  0.017  0.017  0.018  0.018 
## 3   t value   -0.043 1.331  0.981  1.325 
## 4 Pr(> | t| ) 0.966  0.187  0.330  0.189 
## 5   Sharpe    -0.006 0.175  0.132  0.177 
## -----------------------------------------
## 
## Bitcoin Google Search by Groups - bin 2
## =========================================
##       rn      R(t+1) R(t+2) R(t+3) R(t+4)
## -----------------------------------------
## 1  Estimate   0.032  0.090  0.076  0.090 
## 2 Std. Error  0.034  0.043  0.038  0.041 
## 3   t value   0.924  2.088  1.980  2.174 
## 4 Pr(> | t| ) 0.358  0.040  0.051  0.033 
## 5   Sharpe    0.182  0.405  0.384  0.424 
## -----------------------------------------
## 
## Bitcoin Google Search by Groups - bin 3
## =========================================
##       rn      R(t+1) R(t+2) R(t+3) R(t+4)
## -----------------------------------------
## 1  Estimate   0.040  0.050  0.055  0.064 
## 2 Std. Error  0.014  0.015  0.015  0.018 
## 3   t value   2.925  3.449  3.712  3.541 
## 4 Pr(> | t| ) 0.005  0.001  0.0004 0.001 
## 5   Sharpe    0.333  0.393  0.423  0.404 
## -----------------------------------------
## 
## Bitcoin Google Search by Groups - bin 4
## =========================================
##       rn      R(t+1) R(t+2) R(t+3) R(t+4)
## -----------------------------------------
## 1  Estimate   0.012  0.023  0.041  0.026 
## 2 Std. Error  0.015  0.011  0.018  0.018 
## 3   t value   0.824  2.085  2.299  1.445 
## 4 Pr(> | t| ) 0.413  0.040  0.024  0.153 
## 5   Sharpe    0.096  0.249  0.273  0.166 
## -----------------------------------------
## 
## Bitcoin Google Search by Groups - bin 5
## =========================================
##       rn      R(t+1) R(t+2) R(t+3) R(t+4)
## -----------------------------------------
## 1  Estimate   0.110  0.071  0.060  0.045 
## 2 Std. Error  0.030  0.027  0.026  0.021 
## 3   t value   3.724  2.631  2.290  2.147 
## 4 Pr(> | t| ) 0.0004 0.010  0.025  0.035 
## 5   Sharpe    0.471  0.333  0.290  0.270 
## -----------------------------------------
\end{verbatim}

\hypertarget{table-21-google-by-groups-since-2013}{%
\section{Table 21 Google by Groups since
2013}\label{table-21-google-by-groups-since-2013}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{quant_summary =}\StringTok{ }\KeywordTok{list}\NormalTok{()}
\NormalTok{cols =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'R(t+1)'}\NormalTok{,}\StringTok{'R(t+2)'}\NormalTok{,}\StringTok{'R(t+3)'}\NormalTok{,}\StringTok{'R(t+4)'}\NormalTok{)}

\NormalTok{dft}\OperatorTok{$}\NormalTok{rank <-}\StringTok{ }\KeywordTok{rank}\NormalTok{(dft}\OperatorTok{$}\NormalTok{google_norm, }\DataTypeTok{ties.method =} \StringTok{'first'}\NormalTok{)}
\NormalTok{dft}\OperatorTok{$}\NormalTok{bins <-}\StringTok{ }\KeywordTok{apply_quantiles}\NormalTok{(dft}\OperatorTok{$}\NormalTok{rank, }\DataTypeTok{bins=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    0%   20%   40%   60%   80%  100% 
##   0.0  78.2 155.4 232.6 309.8 388.0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{5}\NormalTok{)\{}
  \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{)\{}
\NormalTok{   f <-}\StringTok{ }\KeywordTok{as.formula}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{'weekly_ret_lead'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(j), }\StringTok{'~ google_norm'}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{))}
\NormalTok{     model =}\StringTok{ }\KeywordTok{lm}\NormalTok{(f, }\DataTypeTok{data=}\NormalTok{ dft }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(Date }\OperatorTok{>=}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(}\StringTok{'2013-1-1'}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(bins }\OperatorTok{==}\StringTok{ }\NormalTok{i))}
\NormalTok{     sum <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(model)}
\NormalTok{     sharpe =}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(sum}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{1}\NormalTok{,}\StringTok{'Estimate'}\NormalTok{], }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}\OperatorTok{/}\KeywordTok{sd}\NormalTok{(model}\OperatorTok{$}\NormalTok{model[,}\DecValTok{1}\NormalTok{])}
\NormalTok{     quant_summary[[j]] =}\StringTok{ }\KeywordTok{c}\NormalTok{(sum}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{1}\NormalTok{,], }\DataTypeTok{Sharpe=}\NormalTok{sharpe)}
\NormalTok{  \}}
  
\NormalTok{  single_bin =}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(quant_summary)}
  \KeywordTok{colnames}\NormalTok{(single_bin) <-}\StringTok{ }\NormalTok{cols}
  \CommentTok{#single_bin <- as.data.frame(t(as.matrix(single_bin)))}
  \KeywordTok{setDT}\NormalTok{(single_bin,}\DataTypeTok{keep.rownames =} \OtherTok{TRUE}\NormalTok{)}
  
  \CommentTok{# add *** according to their p value}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\DecValTok{5}\NormalTok{)\{}
\NormalTok{    pvalue <-}\StringTok{ }\NormalTok{single_bin[,..k][}\DecValTok{4}\NormalTok{]}
\NormalTok{    coeff <-}\StringTok{ }\NormalTok{single_bin[,..k][}\DecValTok{1}\NormalTok{]}
    \CommentTok{# if(pvalue < 0.01)\{}
    \CommentTok{#   single_bin[,..k][1] <- paste0(round(coeff,2), '***')}
    \CommentTok{# \}}
\NormalTok{  \}}

  \CommentTok{#names(single_bin) <- c('rn','Value','se', 't', 'pr', 'sd')}
  
  \KeywordTok{stargazer}\NormalTok{(single_bin, }\CommentTok{#type='text', }
            \DataTypeTok{summary=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{title=}\KeywordTok{paste}\NormalTok{(}\StringTok{'Bitcoin Google Search by Groups (since 2013) - bin'}\NormalTok{,i))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:15
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Google Search by Groups (since 2013) - bin 1} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $0.003$ & $0.026$ & $0.020$ & $0.032$ \\ 
## 2 & Std. Error & $0.018$ & $0.018$ & $0.018$ & $0.017$ \\ 
## 3 & t value & $0.175$ & $1.429$ & $1.086$ & $1.878$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.861$ & $0.157$ & $0.281$ & $0.065$ \\ 
## 5 & Sharpe & $0.024$ & $0.193$ & $0.150$ & $0.254$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table} 
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:15
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Google Search by Groups (since 2013) - bin 2} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $$-$0.078$ & $$-$0.024$ & $0.008$ & $0.034$ \\ 
## 2 & Std. Error & $0.043$ & $0.037$ & $0.041$ & $0.047$ \\ 
## 3 & t value & $$-$1.813$ & $$-$0.636$ & $0.206$ & $0.723$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.077$ & $0.528$ & $0.838$ & $0.474$ \\ 
## 5 & Sharpe & $$-$0.912$ & $$-$0.329$ & $0.107$ & $0.373$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table} 
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:15
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Google Search by Groups (since 2013) - bin 3} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $0.083$ & $0.140$ & $0.154$ & $0.193$ \\ 
## 2 & Std. Error & $0.032$ & $0.036$ & $0.040$ & $0.065$ \\ 
## 3 & t value & $2.626$ & $3.857$ & $3.881$ & $2.962$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.021$ & $0.002$ & $0.002$ & $0.011$ \\ 
## 5 & Sharpe & $0.702$ & $1.031$ & $1.037$ & $0.792$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table} 
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:15
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Google Search by Groups (since 2013) - bin 4} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $0.010$ & $0.022$ & $0.031$ & $0.023$ \\ 
## 2 & Std. Error & $0.011$ & $0.011$ & $0.012$ & $0.013$ \\ 
## 3 & t value & $0.945$ & $2.067$ & $2.550$ & $1.715$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.348$ & $0.042$ & $0.013$ & $0.091$ \\ 
## 5 & Sharpe & $0.114$ & $0.249$ & $0.308$ & $0.204$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table} 
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:15
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Google Search by Groups (since 2013) - bin 5} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $0.081$ & $0.057$ & $0.053$ & $0.046$ \\ 
## 2 & Std. Error & $0.026$ & $0.026$ & $0.025$ & $0.022$ \\ 
## 3 & t value & $3.180$ & $2.205$ & $2.129$ & $2.121$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.002$ & $0.031$ & $0.037$ & $0.037$ \\ 
## 5 & Sharpe & $0.413$ & $0.287$ & $0.278$ & $0.275$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table}
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df_google =}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{'trends_bitcoin_weekly_Globe_full.csv'}\NormalTok{)}
\NormalTok{df_google}\OperatorTok{$}\NormalTok{Date =}\StringTok{ }\KeywordTok{ymd}\NormalTok{(df_google}\OperatorTok{$}\NormalTok{date)}
\NormalTok{df_google <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(df_google, Date }\OperatorTok{>=}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(}\StringTok{'2011-1-1'}\NormalTok{))}
\CommentTok{#df_google <- subset(df_google, Date <= as.Date('2018-12-31'))}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{day =} \KeywordTok{wday}\NormalTok{(Date, }\DataTypeTok{week_start =} \KeywordTok{getOption}\NormalTok{(}\StringTok{"lubridate.week.start"}\NormalTok{, }\DecValTok{7}\NormalTok{)))}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{week =} \KeywordTok{cut.Date}\NormalTok{(Date, }\DataTypeTok{breaks=}\StringTok{'1 week'}\NormalTok{, }\DataTypeTok{label=}\OtherTok{FALSE}\NormalTok{))}
\CommentTok{#df_tweets <- df_tweets[, cum:=cumsum(Count)] %>% filter(day == 1)}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(week) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{cum =} \KeywordTok{cumsum}\NormalTok{(bitcoin)) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(day }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{)}

\KeywordTok{setDT}\NormalTok{(df_google)}


\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{)\{}
\NormalTok{  df_google[, }\KeywordTok{paste}\NormalTok{(}\StringTok{'cum_lag'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(i),}\DataTypeTok{sep=}\StringTok{''}\NormalTok{)}\OperatorTok{:}\ErrorTok{=}\StringTok{ }\KeywordTok{shift}\NormalTok{(bitcoin, }\DataTypeTok{n=}\NormalTok{i, }\DataTypeTok{fill=}\OtherTok{NA}\NormalTok{, }\DataTypeTok{type=}\StringTok{'lag'}\NormalTok{)]}
\NormalTok{\}}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google[, avg}\OperatorTok{:}\ErrorTok{=}\KeywordTok{sum}\NormalTok{(cum_lag1}\OperatorTok{+}\NormalTok{cum_lag2}\OperatorTok{+}\NormalTok{cum_lag3}\OperatorTok{+}\NormalTok{cum_lag4,}\DataTypeTok{na.rm =} \OtherTok{TRUE}\NormalTok{)}\OperatorTok{/}\DecValTok{4}\NormalTok{, by=}\KeywordTok{list}\NormalTok{(Date)]}

\CommentTok{# calculate the tweet factor count(t) - average(count(t-1 to t-4))}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google[, google}\OperatorTok{:}\ErrorTok{=}\NormalTok{cum}\OperatorTok{-}\NormalTok{avg, by=}\KeywordTok{list}\NormalTok{(Date)]}
\KeywordTok{setDT}\NormalTok{(df_google)}

\CommentTok{# standardize to mean 0 and sd 1}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google[, google_norm}\OperatorTok{:}\ErrorTok{=}\StringTok{ }\KeywordTok{standardize}\NormalTok{(google)]}

\CommentTok{# plot and describe}
\KeywordTok{qplot}\NormalTok{(}\DataTypeTok{data=}\NormalTok{df_google, }\DataTypeTok{x=}\NormalTok{Date, }\DataTypeTok{y=}\NormalTok{google_norm,}\DataTypeTok{geom =} \StringTok{'line'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project2_files/figure-latex/unnamed-chunk-17-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{describe}\NormalTok{(df_google}\OperatorTok{$}\NormalTok{google_norm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    vars   n mean sd median trimmed  mad   min max range skew kurtosis   se
## X1    1 487    0  1  -0.01   -0.03 0.15 -7.49  11 18.48 2.91    49.99 0.05
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df_google[,date}\OperatorTok{:}\ErrorTok{=}\OtherTok{NULL}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\hypertarget{import-bitcoin-hack-data}{%
\section{Import bitcoin hack data}\label{import-bitcoin-hack-data}}

In this section, we follow the paper to construct the ratio of searches
on bitcoin hack and bitcoin in the raw csv file

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df_google =}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{'trends_bitcoin_hack_weekly_Globe_fullv2.csv'}\NormalTok{)}
\NormalTok{df_google}\OperatorTok{$}\NormalTok{Date =}\StringTok{ }\KeywordTok{ymd}\NormalTok{(df_google}\OperatorTok{$}\NormalTok{date)}
\NormalTok{df_google <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(df_google, Date }\OperatorTok{>=}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(}\StringTok{'2011-1-1'}\NormalTok{))}
\NormalTok{df_google <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(df_google, Date }\OperatorTok{<=}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(}\StringTok{'2018-12-31'}\NormalTok{))}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{day =} \KeywordTok{wday}\NormalTok{(Date, }\DataTypeTok{week_start =} \KeywordTok{getOption}\NormalTok{(}\StringTok{"lubridate.week.start"}\NormalTok{, }\DecValTok{7}\NormalTok{)))}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{week =} \KeywordTok{cut.Date}\NormalTok{(Date, }\DataTypeTok{breaks=}\StringTok{'1 week'}\NormalTok{, }\DataTypeTok{label=}\OtherTok{FALSE}\NormalTok{))}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(week) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{cum =} \KeywordTok{cumsum}\NormalTok{(bitcoin)) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(day }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{)}

\KeywordTok{setDT}\NormalTok{(df_google)}

\CommentTok{#df_google <- df_google[, google_norm:= BBmisc::normalize(bitcoin,method = "range", range=c(-1,1))]}
\NormalTok{df_google <-}\StringTok{ }\NormalTok{df_google[, google_norm}\OperatorTok{:}\ErrorTok{=}\StringTok{ }\KeywordTok{standardize}\NormalTok{(bitcoin)]}
\KeywordTok{qplot}\NormalTok{(}\DataTypeTok{data=}\NormalTok{df_google, }\DataTypeTok{x=}\NormalTok{Date, }\DataTypeTok{y=}\NormalTok{google_norm,}\DataTypeTok{geom =} \StringTok{'line'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project2_files/figure-latex/unnamed-chunk-19-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{describe}\NormalTok{(df_google}\OperatorTok{$}\NormalTok{google_norm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    vars   n mean sd median trimmed  mad   min  max range skew kurtosis   se
## X1    1 418    0  1  -0.37   -0.09 0.95 -1.31 3.82  5.13 0.85     0.17 0.05
\end{verbatim}

\hypertarget{table---bitcoin-hack}{%
\section{Table \{\} - Bitcoin Hack}\label{table---bitcoin-hack}}

After running the regression, we also find very similar time-series
momentum on the phrase bitcoin hack

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dft<-}\KeywordTok{merge}\NormalTok{(bitcoin_weekly, df_google, }\DataTypeTok{by=}\StringTok{'Date'}\NormalTok{)}
\NormalTok{quant_summary =}\StringTok{ }\KeywordTok{list}\NormalTok{()}
\NormalTok{model_results4 =}\StringTok{ }\KeywordTok{list}\NormalTok{()}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{7}\NormalTok{)\{}
\NormalTok{   f <-}\StringTok{ }\KeywordTok{as.formula}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{'weekly_ret_lead'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(i), }\StringTok{'~ google_norm'}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{))}
\NormalTok{   m =}\StringTok{ }\KeywordTok{lm}\NormalTok{(f, }\DataTypeTok{data=}\NormalTok{ dft)}
\NormalTok{   model_results4[[i]] =}\StringTok{ }\NormalTok{m}
\NormalTok{\}}

\KeywordTok{stargazer}\NormalTok{(model_results4, }\DataTypeTok{header=}\NormalTok{F,}\CommentTok{#type='text',}
            \DataTypeTok{title=}\KeywordTok{paste}\NormalTok{(}\StringTok{'Google Search - Bitcoin Hack to Bitcoin search ('}\NormalTok{, }\KeywordTok{paste}\NormalTok{(}\KeywordTok{min}\NormalTok{(dft}\OperatorTok{$}\NormalTok{Date)),}\StringTok{'-'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(}\KeywordTok{max}\NormalTok{(dft}\OperatorTok{$}\NormalTok{Date)),}\StringTok{')'}\NormalTok{),}
            \DataTypeTok{omit.stat =} \KeywordTok{c}\NormalTok{(}\StringTok{"LL"}\NormalTok{,}\StringTok{"ser"}\NormalTok{,}\StringTok{"f"}\NormalTok{),}
            \DataTypeTok{covariate.labels =}\KeywordTok{c}\NormalTok{(}\StringTok{'Google(t)'}\NormalTok{),}
            \DataTypeTok{dep.var.labels=}\KeywordTok{c}\NormalTok{(}\StringTok{'R(t+1)'}\NormalTok{, }\StringTok{'R(t+2)'}\NormalTok{, }\StringTok{'R(t+3)'}\NormalTok{, }\StringTok{'R(t+4)'}\NormalTok{,}\StringTok{'R(t+5)'}\NormalTok{,}\StringTok{'R(t+6)'}\NormalTok{,}\StringTok{'R(t+7)'}\NormalTok{),}
            \DataTypeTok{omit=}\StringTok{'Constant'}\NormalTok{,}
            \DataTypeTok{report =} \StringTok{"vc*pt"}\NormalTok{, }\DataTypeTok{flip=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## \begin{table}[!htbp] \centering 
##   \caption{Google Search - Bitcoin Hack to Bitcoin search ( 2011-01-02 - 2018-05-27 )} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}}lccccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & \multicolumn{7}{c}{\textit{Dependent variable:}} \\ 
## \cline{2-8} 
## \\[-1.8ex] & R(t+1) & R(t+2) & R(t+3) & R(t+4) & R(t+5) & R(t+6) & R(t+7) \\ 
## \\[-1.8ex] & (1) & (2) & (3) & (4) & (5) & (6) & (7)\\ 
## \hline \\[-1.8ex] 
##  Google(t) & $-$0.029$^{***}$ & $-$0.024$^{***}$ & $-$0.019$^{**}$ & $-$0.020$^{**}$ & $-$0.025$^{***}$ & $-$0.016$^{**}$ & $-$0.016$^{**}$ \\ 
##   & p = 0.0005 & p = 0.005 & p = 0.022 & p = 0.016 & p = 0.004 & p = 0.047 & p = 0.048 \\ 
##   & t = $-$3.549 & t = $-$2.886 & t = $-$2.316 & t = $-$2.443 & t = $-$2.964 & t = $-$1.993 & t = $-$1.988 \\ 
##   & & & & & & & \\ 
## \hline \\[-1.8ex] 
## Observations & 386 & 385 & 384 & 383 & 382 & 381 & 380 \\ 
## R$^{2}$ & 0.032 & 0.021 & 0.014 & 0.015 & 0.023 & 0.010 & 0.010 \\ 
## Adjusted R$^{2}$ & 0.029 & 0.019 & 0.011 & 0.013 & 0.020 & 0.008 & 0.008 \\ 
## \hline 
## \hline \\[-1.8ex] 
## \textit{Note:}  & \multicolumn{7}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ 
## \end{tabular} 
## \end{table}
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ggplot(dft, aes(x=Date)) + }
\CommentTok{#   geom_line(aes(y = dft$weekly_ret), color = "darkred") + }
\CommentTok{#   geom_line(aes(y = dft$google_norm), color="blue", linetype="twodash")}
\CommentTok{#   #geom_line(aes(y = dft$tweet_norm), color="green", linetype="twodash") }
\end{Highlighting}
\end{Shaded}

\hypertarget{table---bitcoin-hack-by-groups}{%
\section{Table \{\} - Bitcoin hack by
groups}\label{table---bitcoin-hack-by-groups}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{quant_summary =}\StringTok{ }\KeywordTok{list}\NormalTok{()}
\NormalTok{cols =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'R(t+1)'}\NormalTok{,}\StringTok{'R(t+2)'}\NormalTok{,}\StringTok{'R(t+3)'}\NormalTok{,}\StringTok{'R(t+4)'}\NormalTok{)}

\CommentTok{#dft$rank <- rank(dft$google_norm, ties.method = 'first')}
\NormalTok{dft}\OperatorTok{$}\NormalTok{bins <-}\StringTok{ }\KeywordTok{apply_quantiles}\NormalTok{(dft}\OperatorTok{$}\NormalTok{google_norm, }\DataTypeTok{bins=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         0%        20%        40%        60%        80%       100% 
## -2.3068470 -0.7417623 -0.5179048  0.2710374  1.0599796  4.8212774
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{5}\NormalTok{)\{}
  \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{)\{}
\NormalTok{   f <-}\StringTok{ }\KeywordTok{as.formula}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{'weekly_ret_lead'}\NormalTok{,}\KeywordTok{paste}\NormalTok{(j), }\StringTok{'~ google_norm'}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{))}
\NormalTok{     model =}\StringTok{ }\KeywordTok{lm}\NormalTok{(f, }\DataTypeTok{data=}\NormalTok{ dft }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(bins }\OperatorTok{==}\StringTok{ }\NormalTok{i))}
\NormalTok{     sum <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(model)}
\NormalTok{     sharpe =}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(sum}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{1}\NormalTok{,}\StringTok{'Estimate'}\NormalTok{], }\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)}\OperatorTok{/}\KeywordTok{sd}\NormalTok{(model}\OperatorTok{$}\NormalTok{model[,}\DecValTok{1}\NormalTok{])}
\NormalTok{     quant_summary[[j]] =}\StringTok{ }\KeywordTok{c}\NormalTok{(sum}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{1}\NormalTok{,], }\DataTypeTok{Sharpe=}\NormalTok{sharpe)}
\NormalTok{  \}}
  
\NormalTok{  single_bin =}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(quant_summary)}
  \KeywordTok{colnames}\NormalTok{(single_bin) <-}\StringTok{ }\NormalTok{cols}
  \CommentTok{#single_bin <- as.data.frame(t(as.matrix(single_bin)))}
  \KeywordTok{setDT}\NormalTok{(single_bin,}\DataTypeTok{keep.rownames =} \OtherTok{TRUE}\NormalTok{)}
  
  \CommentTok{# add *** according to their p value}
  \ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\DecValTok{5}\NormalTok{)\{}
\NormalTok{    pvalue <-}\StringTok{ }\NormalTok{single_bin[,..k][}\DecValTok{4}\NormalTok{]}
\NormalTok{    coeff <-}\StringTok{ }\NormalTok{single_bin[,..k][}\DecValTok{1}\NormalTok{]}
    \CommentTok{# if(pvalue < 0.01)\{}
    \CommentTok{#   single_bin[,..k][1] <- paste0(round(coeff,2), '***')}
    \CommentTok{# \}}
\NormalTok{  \}}

  \CommentTok{#names(single_bin) <- c('rn','Value','se', 't', 'pr', 'sd')}
  
  \KeywordTok{stargazer}\NormalTok{(single_bin, }\CommentTok{#type='text',}
             \DataTypeTok{summary=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{title=}\KeywordTok{paste}\NormalTok{(}\StringTok{'Bitcoin Hack by Groups - bin'}\NormalTok{,i))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:16
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Hack by Groups - bin 1} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $0.010$ & $$-$0.080$ & $$-$0.138$ & $$-$0.224$ \\ 
## 2 & Std. Error & $0.159$ & $0.148$ & $0.141$ & $0.149$ \\ 
## 3 & t value & $0.061$ & $$-$0.545$ & $$-$0.980$ & $$-$1.503$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.951$ & $0.587$ & $0.330$ & $0.137$ \\ 
## 5 & Sharpe & $0.038$ & $$-$0.331$ & $$-$0.593$ & $$-$0.912$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table} 
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:16
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Hack by Groups - bin 2} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $$-$0.009$ & $0.233$ & $$-$0.013$ & $$-$0.048$ \\ 
## 2 & Std. Error & $0.149$ & $0.165$ & $0.173$ & $0.149$ \\ 
## 3 & t value & $$-$0.058$ & $1.412$ & $$-$0.074$ & $$-$0.321$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.954$ & $0.161$ & $0.941$ & $0.749$ \\ 
## 5 & Sharpe & $$-$0.050$ & $1.196$ & $$-$0.064$ & $$-$0.276$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table} 
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:16
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Hack by Groups - bin 3} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $0.038$ & $0.037$ & $0.028$ & $0.038$ \\ 
## 2 & Std. Error & $0.014$ & $0.014$ & $0.015$ & $0.017$ \\ 
## 3 & t value & $2.730$ & $2.642$ & $1.835$ & $2.219$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.008$ & $0.010$ & $0.070$ & $0.029$ \\ 
## 5 & Sharpe & $0.288$ & $0.285$ & $0.198$ & $0.239$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table} 
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:16
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Hack by Groups - bin 4} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $0.019$ & $0.013$ & $$-$0.005$ & $$-$0.017$ \\ 
## 2 & Std. Error & $0.043$ & $0.042$ & $0.039$ & $0.045$ \\ 
## 3 & t value & $0.432$ & $0.314$ & $$-$0.122$ & $$-$0.364$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.668$ & $0.754$ & $0.903$ & $0.717$ \\ 
## 5 & Sharpe & $0.213$ & $0.155$ & $$-$0.060$ & $$-$0.179$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table} 
## 
## % Table created by stargazer v.5.2.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
## % Date and time: 週三, 五月 20, 2020 - 上午 01:14:16
## \begin{table}[!htbp] \centering 
##   \caption{Bitcoin Hack by Groups - bin 5} 
##   \label{} 
## \begin{tabular}{@{\extracolsep{5pt}} cccccc} 
## \\[-1.8ex]\hline 
## \hline \\[-1.8ex] 
##  & rn & R(t+1) & R(t+2) & R(t+3) & R(t+4) \\ 
## \hline \\[-1.8ex] 
## 1 & Estimate & $0.026$ & $$-$0.023$ & $0.045$ & $0.032$ \\ 
## 2 & Std. Error & $0.027$ & $0.034$ & $0.040$ & $0.036$ \\ 
## 3 & t value & $0.985$ & $$-$0.656$ & $1.119$ & $0.901$ \\ 
## 4 & Pr(\textgreater \textbar t\textbar ) & $0.329$ & $0.515$ & $0.268$ & $0.372$ \\ 
## 5 & Sharpe & $0.489$ & $$-$0.327$ & $0.558$ & $0.451$ \\ 
## \hline \\[-1.8ex] 
## \end{tabular} 
## \end{table}
\end{verbatim}

\hypertarget{pnl-curve-for-momentum-based-strategy}{%
\section{pnl curve for momentum based
strategy}\label{pnl-curve-for-momentum-based-strategy}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df_google}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            date bitcoin_hack bitcoin_search   bitcoin       Date day week
##   1:   2011/1/2            0              0 0.0000000 2011-01-02   1    1
##   2:   2011/1/9            0              0 0.0000000 2011-01-09   1    2
##   3:  2011/1/16            0              0 0.0000000 2011-01-16   1    3
##   4:  2011/1/23            0              0 0.0000000 2011-01-23   1    4
##   5:  2011/1/30            0              0 0.0000000 2011-01-30   1    5
##  ---                                                                     
## 414:  2018/12/2           12             12 1.0000000 2018-12-02   1  414
## 415:  2018/12/9            5             11 0.4545455 2018-12-09   1  415
## 416: 2018/12/16            7             11 0.6363636 2018-12-16   1  416
## 417: 2018/12/23           10             10 1.0000000 2018-12-23   1  417
## 418: 2018/12/30            6              9 0.6666667 2018-12-30   1  418
##            cum google_norm
##   1: 0.0000000  -1.3068470
##   2: 0.0000000  -1.3068470
##   3: 0.0000000  -1.3068470
##   4: 0.0000000  -1.3068470
##   5: 0.0000000  -1.3068470
##  ---                      
## 414: 1.0000000  -0.5179048
## 415: 0.4545455  -0.9482369
## 416: 0.6363636  -0.8047929
## 417: 1.0000000  -0.5179048
## 418: 0.6666667  -0.7808855
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dft<-}\KeywordTok{merge}\NormalTok{(bitcoin_weekly, df_google, }\DataTypeTok{by=}\StringTok{'Date'}\NormalTok{)}
\CommentTok{#dft<- subset(dft, Date <= as.Date('2018-12-31'))}
\NormalTok{strategy <-}\StringTok{ }\NormalTok{dft[,}\KeywordTok{list}\NormalTok{(Close, google_norm, weekly_ret,bins), by=}\KeywordTok{list}\NormalTok{(Date)]}
\CommentTok{#strategy[,google_norm_lag1:=shift(google_norm, n=1, fill=NA, type='lag')]}
\NormalTok{strategy[,weekly_ret_lead1}\OperatorTok{:}\ErrorTok{=}\KeywordTok{shift}\NormalTok{(weekly_ret, }\DataTypeTok{n=}\DecValTok{1}\NormalTok{, }\DataTypeTok{fill=}\OtherTok{NA}\NormalTok{, }\DataTypeTok{type=}\StringTok{'lag'}\NormalTok{)]}
\NormalTok{strategy}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            Date     Close google_norm  weekly_ret bins weekly_ret_lead1
##   1: 2011-01-02    0.3000  -1.3068470          NA   NA               NA
##   2: 2011-01-09    0.3230  -1.3068470  0.07666667    4               NA
##   3: 2011-01-16    0.3868  -1.3068470  0.19752322    5       0.07666667
##   4: 2011-01-23    0.4424  -1.3068470  0.14374354    5       0.19752322
##   5: 2011-01-30    0.4799  -1.3068470  0.08476492    4       0.14374354
##  ---                                                                   
## 383: 2018-04-29 9392.0313  -0.7151403  0.06814658    4       0.05214677
## 384: 2018-05-06 9619.1438  -0.8213441  0.02418140    3       0.06814658
## 385: 2018-05-13 8688.0288  -0.6613488 -0.09679812    1       0.02418140
## 386: 2018-05-20 8520.8125  -0.3744608 -0.01924675    2      -0.09679812
## 387: 2018-05-27 7344.9675  -0.5967990 -0.13799682    1      -0.01924675
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dft}\OperatorTok{$}\NormalTok{rank <-}\StringTok{ }\KeywordTok{rank}\NormalTok{(dft}\OperatorTok{$}\NormalTok{google_norm, }\DataTypeTok{ties.method =} \StringTok{'first'}\NormalTok{)}
\NormalTok{dft}\OperatorTok{$}\NormalTok{bins <-}\StringTok{ }\KeywordTok{apply_quantiles}\NormalTok{(dft}\OperatorTok{$}\NormalTok{rank, }\DataTypeTok{bins=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    0%   20%   40%   60%   80%  100% 
##   0.0  78.2 155.4 232.6 309.8 388.0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dft}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            Date     Close Close_lag1      plot_ret           ret    ret_lead1
##   1: 2011-01-02    0.3000     0.3000  0.0000000000  0.0000000000 -0.016666667
##   2: 2011-01-09    0.3230     0.3229  0.0003096934  0.0003096934  0.011145511
##   3: 2011-01-16    0.3868     0.3860  0.0020725389  0.0020725389 -0.096432265
##   4: 2011-01-23    0.4424     0.4443 -0.0042763898 -0.0042763898 -0.050858951
##   5: 2011-01-30    0.4799     0.4390  0.0931662870  0.0931662870  0.083559075
##  ---                                                                         
## 383: 2018-04-29 9392.0313  9342.4713  0.0053048062  0.0053048062 -0.015727034
## 384: 2018-05-06 9619.1438  9826.5975 -0.0211114478 -0.0211114478 -0.026677010
## 385: 2018-05-13 8688.0288  8467.6563  0.0260252061  0.0260252061 -0.001475881
## 386: 2018-05-20 8520.8125  8234.1525  0.0348135403  0.0348135403 -0.014738031
## 387: 2018-05-27 7344.9675  7334.1638  0.0014730650  0.0014730650 -0.032579450
##        ret_lead2   ret_lead3    ret_lead4    ret_lead5     ret_lead6
##   1:  0.01355932  0.00000000 -0.003344482  0.073825503  0.0090625000
##   2:  0.00000000 -0.02388242 -0.003764115  0.259445844 -0.0350000000
##   3: -0.10443491  0.00000000  0.246006390  0.076666667  0.0581090736
##   4: -0.02357704  0.01707317  0.010071942  0.058879392 -0.0156950673
##   5:  0.34615385  0.02285714 -0.036312849  0.175362319  0.1344019729
##  ---                                                                
## 383: -0.01910443  0.01677918  0.055837181 -0.004310108  0.0138124319
## 384: -0.01947924  0.01370795 -0.031311519 -0.067494840  0.0073138258
## 385: -0.02316573 -0.01580555 -0.033775169  0.022599597 -0.0007975633
## 386: -0.04904152 -0.06024396  0.010147538 -0.015569641 -0.0169595487
## 387:  0.04994760 -0.01138166  0.015119643           NA            NA
##          ret_lead7 day.x week.x Close_lead1w Close_lag1w  weekly_ret
##   1:  0.0003096934     1      2       0.3230          NA          NA
##   2:  0.0020725389     1      3       0.3868      0.3000  0.07666667
##   3: -0.0042763898     1      4       0.4424      0.3230  0.19752322
##   4:  0.0931662870     1      5       0.4799      0.3868  0.14374354
##   5: -0.0220652174     1      6       0.8997      0.4424  0.08476492
##  ---                                                                
## 383: -0.0211114478     1    384    9619.1438   8792.8300  0.06814658
## 384:  0.0260252061     1    385    8688.0288   9392.0313  0.02418140
## 385:  0.0348135403     1    386    8520.8125   9619.1438 -0.09679812
## 386:  0.0014730650     1    387    7344.9675   8688.0288 -0.01924675
## 387:            NA     1    388           NA   8520.8125 -0.13799682
##      weekly_ret_lead1 weekly_ret_lead2 weekly_ret_lead3 weekly_ret_lead4
##   1:       0.07666667       0.19752322       0.14374354       0.08476492
##   2:       0.19752322       0.14374354       0.08476492       0.87476558
##   3:       0.14374354       0.08476492       0.87476558       0.16705569
##   4:       0.08476492       0.87476558       0.16705569      -0.19047619
##   5:       0.87476558       0.16705569      -0.19047619       0.04705882
##  ---                                                                    
## 383:       0.02418140      -0.09679812      -0.01924675      -0.13799682
## 384:      -0.09679812      -0.01924675      -0.13799682               NA
## 385:      -0.01924675      -0.13799682               NA               NA
## 386:      -0.13799682               NA               NA               NA
## 387:               NA               NA               NA               NA
##      weekly_ret_lead5 weekly_ret_lead6 weekly_ret_lead7 bins      date
##   1:       0.87476558      0.167055685     -0.190476190    1  2011/1/2
##   2:       0.16705569     -0.190476190      0.047058824    1  2011/1/9
##   3:      -0.19047619      0.047058824      0.011123596    1 2011/1/16
##   4:       0.04705882      0.011123596     -0.008223136    1 2011/1/23
##   5:       0.01112360     -0.008223136     -0.169635854    1 2011/1/30
##  ---                                                                  
## 383:               NA               NA               NA    2 2018/4/29
## 384:               NA               NA               NA    1  2018/5/6
## 385:               NA               NA               NA    2 2018/5/13
## 386:               NA               NA               NA    3 2018/5/20
## 387:               NA               NA               NA    2 2018/5/27
##      bitcoin_hack bitcoin_search   bitcoin day.y week.y       cum google_norm
##   1:            0              0 0.0000000     1      1 0.0000000  -1.3068470
##   2:            0              0 0.0000000     1      2 0.0000000  -1.3068470
##   3:            0              0 0.0000000     1      3 0.0000000  -1.3068470
##   4:            0              0 0.0000000     1      4 0.0000000  -1.3068470
##   5:            0              0 0.0000000     1      5 0.0000000  -1.3068470
##  ---                                                                         
## 383:            9             12 0.7500000     1    383 0.7500000  -0.7151403
## 384:            8             13 0.6153846     1    384 0.6153846  -0.8213441
## 385:            9             11 0.8181818     1    385 0.8181818  -0.6613488
## 386:           13             11 1.1818182     1    386 1.1818182  -0.3744608
## 387:            9             10 0.9000000     1    387 0.9000000  -0.5967990
##      rank
##   1:    1
##   2:    2
##   3:    3
##   4:    4
##   5:    5
##  ---     
## 383:   83
## 384:   72
## 385:   91
## 386:  183
## 387:  102
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#compute the pnl for buynhold}
\NormalTok{strategy[,buynhold}\OperatorTok{:}\ErrorTok{=}\KeywordTok{cumprod}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\KeywordTok{ifelse}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(weekly_ret), }\DecValTok{0}\NormalTok{, weekly_ret))}\OperatorTok{-}\DecValTok{1}\NormalTok{]}

\CommentTok{# if bins == 1, we do nothing and long if bin equal to 5}
\NormalTok{strategy[,position}\OperatorTok{:}\ErrorTok{=}\KeywordTok{ifelse}\NormalTok{(bins }\OperatorTok{==}\StringTok{ }\DecValTok{5}\NormalTok{, }\DecValTok{1}\NormalTok{ ,}\KeywordTok{ifelse}\NormalTok{((bins}\OperatorTok{==}\DecValTok{1}\NormalTok{),}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{))]}
\NormalTok{strategy[,momentum}\OperatorTok{:}\ErrorTok{=}\NormalTok{weekly_ret_lead1}\OperatorTok{*}\NormalTok{position]}
\NormalTok{strategy[,cum_momentum}\OperatorTok{:}\ErrorTok{=}\KeywordTok{cumprod}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\KeywordTok{ifelse}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(momentum), }\DecValTok{0}\NormalTok{, momentum))}\OperatorTok{-}\DecValTok{1}\NormalTok{]}
\NormalTok{strategy}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            Date     Close google_norm  weekly_ret bins weekly_ret_lead1
##   1: 2011-01-02    0.3000  -1.3068470          NA   NA               NA
##   2: 2011-01-09    0.3230  -1.3068470  0.07666667    4               NA
##   3: 2011-01-16    0.3868  -1.3068470  0.19752322    5       0.07666667
##   4: 2011-01-23    0.4424  -1.3068470  0.14374354    5       0.19752322
##   5: 2011-01-30    0.4799  -1.3068470  0.08476492    4       0.14374354
##  ---                                                                   
## 383: 2018-04-29 9392.0313  -0.7151403  0.06814658    4       0.05214677
## 384: 2018-05-06 9619.1438  -0.8213441  0.02418140    3       0.06814658
## 385: 2018-05-13 8688.0288  -0.6613488 -0.09679812    1       0.02418140
## 386: 2018-05-20 8520.8125  -0.3744608 -0.01924675    2      -0.09679812
## 387: 2018-05-27 7344.9675  -0.5967990 -0.13799682    1      -0.01924675
##            buynhold position    momentum  cum_momentum
##   1:     0.00000000       NA          NA    0.00000000
##   2:     0.07666667        1          NA    0.00000000
##   3:     0.28933333        1  0.07666667    0.07666667
##   4:     0.47466667        1  0.19752322    0.28933333
##   5:     0.59966667        1  0.14374354    0.47466667
##  ---                                                  
## 383: 31305.77100000        1  0.05214677 7214.22498369
## 384: 32062.81266667        1  0.06814658 7705.91789599
## 385: 28959.09600000        0  0.00000000 7705.91789599
## 386: 28401.70833333        1 -0.09679812 6959.90276139
## 387: 24482.22500000        0  0.00000000 6959.90276139
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(strategy, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{Date)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ strategy}\OperatorTok{$}\NormalTok{buynhold}\OperatorTok{+}\DecValTok{1}\NormalTok{), }\DataTypeTok{color =} \StringTok{"darkred"}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ strategy}\OperatorTok{$}\NormalTok{cum_momentum}\OperatorTok{+}\DecValTok{1}\NormalTok{), }\DataTypeTok{color =} \StringTok{"blue"}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{scale_y_log10}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{project2_files/figure-latex/unnamed-chunk-23-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(PerformanceAnalytics)}
\CommentTok{#SharpeRatio.annualized(R, Rf = 0.002, scale = 52, geometric = TRUE)}
\end{Highlighting}
\end{Shaded}

```

Add a new chunk by clicking the \emph{Insert Chunk} button on the
toolbar or by pressing \emph{Ctrl+Alt+I}.

When you save the notebook, an HTML file containing the code and output
will be saved alongside it (click the \emph{Preview} button or press
\emph{Ctrl+Shift+K} to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the
editor. Consequently, unlike \emph{Knit}, \emph{Preview} does not run
any R code chunks. Instead, the output of the chunk when it was last run
in the editor is displayed.

\end{document}
